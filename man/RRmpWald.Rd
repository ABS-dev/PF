% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RRmpWald.r
\name{RRmpWald}
\alias{RRmpWald}
\title{Wald confidence intervals for RR from matched pairs}
\usage{
RRmpWald(formula = NULL, data = NULL, compare = c("vac", "con"),
  affected = 1, x, alpha = 0.05, pf = TRUE, tdist = TRUE,
  df = NULL, rnd = 3)
}
\arguments{
\item{formula}{Formula of the form \code{y ~ x + cluster(w)}, where y is the 
indicator for an individual's positive response, x is a factor with two levels 
of treatment, and w identifies the pairs.}

\item{data}{\code{data.frame} containing variables in formula}

\item{compare}{Text vector stating the factor levels: compare[1] is the vaccinate
group to which compare[2] (control or reference) is compared.}

\item{affected}{Indicator for positive response}

\item{x}{Alternative data input. Instead of formula and data frame, data may 
be input as frequency vector. See example for how to order this vector.}

\item{alpha}{Complement of the confidence level}

\item{pf}{Estimate \emph{RR} or its complement \emph{PF}?}

\item{tdist}{Use t distribution?}

\item{df}{Degrees of freedom. When NULL, the function will default to 
\code{df = N - 2}, where N is the total number of pairs.}

\item{rnd}{Number of digits for rounding. Affects display only, not estimates.}
}
\value{
A \code{\link{rrmp}} object with the following fields:
 \item{estimate}{vector of point and interval estimates - see details}
 \item{estimator}{either \code{"PF"} or \code{"RR"}}
 \item{compare}{text vector, same as input}
 \item{alpha}{complement of confidence level}
 \item{rnd}{how many digits to round the display}
 \item{multvec}{data frame showing the multinomial representation of the data}
}
\description{
Estimates confidence intervals for the risk ratio or prevented fraction from matched pairs.
}
\details{
Estimates confidence intervals for the risk ratio or prevented fraction from matched pairs.
The response is the tetranomial vector [11, 12, 21, 22], where the first index is the row and the
the second index is the column when displayed as a 2x2 table. Wald type confidence intervals are found by
applying the delta method to the multinomial variance. This method fails when there are no responders in one of the treatment groups.
\cr \cr Alternative forms of data entry are illustrated by the output, say  \cr
\code{Y}, where \code{c(Y$xtable) = Y$freqvec = Y$multvec$Freq}.
\cr \cr If RR = 0 (PF = 1), the function will return degenerate interval.
}
\note{
Experimental functions for estimating profile likelihood intervals are 
in the CVBmisc package. \cr \cr
Call to this function may be one of two formats: (1) specify \code{data} and 
\code{formula} or (2) as a vector  \code{x} \cr \cr
\code{RRmpWald(formula, data, compare = c('vac', 'con'), affected = 1, 
alpha = 0.05,} \cr
\code{pf = TRUE, tdist = TRUE, df = NULL, rnd = 3)} \cr \cr
\code{RRmpWald(x, compare = c('vac', 'con'), affected = 1, alpha = 0,05,} \cr 
\code{pf = TRUE, tdist = TRUE, df = NULL, rnd = 3)}
}
\examples{
RRmpWald(pos ~ tx + cluster(cage), New, compare = c('vac', 'con'))

# PF 
# 95\% interval estimates
#
#    PF    LL    UL 
# 0.550 0.183 0.752 

require(magrittr)
thistable <- New \%>\%
  tidyr::spread(tx, pos) \%>\%
  dplyr::mutate(vac = factor(vac, levels = 1:0),
    con = factor(con, levels = 1:0)) \%>\%
  with(., table(vac, con)) 
thistable
#    con
# vac  1  0
#   1  7  2
#   0 13  4
as.vector(thistable)
# [1]  7 13  2  4

RRmpWald(x = as.vector(thistable))

# PF 
# 95\% interval estimates
#
#    PF    LL    UL 
# 0.550 0.183 0.752 
}
\author{
David Siev \email{david.siev@aphis.usda.gov}
}
