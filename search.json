[{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"PF Vignette","text":"PF package collection functions related estimating prevented fraction, \\(PF=1-RR\\) , \\(RR={{{\\pi}_{2}}}/{{{\\pi}_{1}}}\\;\\) .","code":""},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"technical-notes","dir":"Articles","previous_headings":"1 Introduction","what":"Technical notes","title":"PF Vignette","text":"Optimization. Unless otherwise stated, optimization DUD algorithm (Ralston Jennrich 1978). Level tested. help files indicate level testing undergone function. cases subjective judgement, since functions originally tested SPlus ported R recently.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"the-score-statistic","dir":"Articles","previous_headings":"2 Score based methods","what":"The score statistic","title":"PF Vignette","text":"Confidence intervals risk ratio may based score statistic Miettinen Nurminen (1985), \\[\\frac{{{{\\hat{\\pi }}}_{2}}-{{\\rho }_{0}}{{{\\hat{\\pi }}}_{1}}}{\\sqrt{\\left( {{{{\\tilde{\\pi }}}_{2}}(1-{{{\\tilde{\\pi }}}_{2}})}/{{{n}_{2}}}\\; \\right)+\\rho _{0}^{2}\\left( {{{{\\tilde{\\pi }}}_{1}}(1-{{{\\tilde{\\pi }}}_{1}})}/{{{n}_{1}}}\\; \\right)}}\\] hat indicates MLE tilde indicates MLE restriction \\(\\rho ={{\\rho }_{0}}\\).","code":""},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"asymptotic-intervals","dir":"Articles","previous_headings":"2 Score based methods","what":"Asymptotic intervals","title":"PF Vignette","text":"RRsc() estimates asymptotic confidence intervals risk ratio prevented fraction based score statistic. Interval estimates returned three estimators. score method originally introduced (Koopman 1984). Gart Nam’s modification includes skewness correction (Gart Nam 1988). method (Miettinen Nurminen 1985) version made slightly conservative Koopman’s including factor \\({(N-1)}/{N}\\;\\). Starting estimates algorithm obtained modified Katz method (log method 0.5 added cell). forms Katz estimate may retrieved returned object using RRsc()\\$estimate.","code":"require(PF) ## Loading required package: PF RRsc(c(4, 24, 12, 28)) ##  ## PF  ## 95% interval estimates ##  ##                 PF     LL    UL ## MN method    0.611 0.0251 0.857 ## score method 0.611 0.0328 0.855 ## skew corr    0.611 0.0380 0.876"},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"exact-intervals","dir":"Articles","previous_headings":"2 Score based methods","what":"Exact intervals","title":"PF Vignette","text":"methods give intervals `exact’ sense based actual sampling distribution rather approximation . score statistic used select \\(2 \\times 2\\) tables fall tail area, binomial probability estimated tail area taking maximum nuisance parameter. search tail area made efficient Berger-Boos correction (Berger Boos 1994). RRtosst() gives intervals obtained inverting two one-sided score tests; RRotsst() gives intervals obtained inverting one two-sided score test. RRtosst() thus conservative, preserving least \\({\\alpha }/{2}\\;\\) tail. (Agresti Min 2001) discuss properties relative benefits two approaches. price exactnesss conservatism, due discreteness binomial distribution (Agresti 2001). means actual coverage confidence interval exactly conform nominal coverage, less . (See also (Agresti 2003).) functions use simple step search algorithm.","code":"RRotsst(c(4, 24, 12, 28)) ##  ## PF  ## 95% interval estimates ##  ##     PF     LL     UL  ## 0.6111 0.0148 0.8519 RRtosst(c(4, 24, 12, 28)) ##  ## PF  ## 95% interval estimates ##  ##    PF    LL    UL  ## 0.611 0.012 0.902"},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"stratified-designs","dir":"Articles","previous_headings":"","what":"Stratified designs","title":"PF Vignette","text":"Methods estimating common RR stratified clustered designs depend homogeneity respect common parameter.","code":""},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"gart-nam-score-method","dir":"Articles","previous_headings":"3 Stratified designs","what":"Gart-Nam score method","title":"PF Vignette","text":"(Gart 1985) (Gart Nam 1988) derived score statistic common estimate RR designs multiple independent strata, showed identical one proposed (Radhakrishnan 1965) different perspective. RRstr() provides confidence intervals homogeneity test based Gart’s statistic. Data may input two ways, either using formula data frame, matrix.","code":"RRstr(cbind(y, n) ~ tx + cluster(clus), Table6,       compare = c(\"a\", \"b\"), pf = FALSE) ##  ## Test of homogeneity across clusters ##  ## stat  0.954  ## df    3  ## p     0.812  ##  ## RR  ## 95% interval estimates ##  ##             RR   LL   UL ## starting  2.66 1.37 5.18 ## mle       2.65 1.39 5.03 ## skew corr 2.65 1.31 5.08 # Data matrix input: RRstr(Y = table6, pf = F)"},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"mantel-haenszel-estimator","dir":"Articles","previous_headings":"3 Stratified designs","what":"Mantel-Haenszel estimator","title":"PF Vignette","text":"widely-used heuristic method sparse frequency tables weighted average approach (Mantel Haenszel 1959)1. MH interval estimates based asymptotic normality log risk ratio. RRmh() utilizes variance estimator given (Greenland Robins 1985) sparse strata. resulting asymptotic estimator consistent case sparse strata number strata assumed increasing, case limited number strata stratum size assumed increasing. latter case, however, less efficient maximum likelihood Greenland Robins (1985). Additional discussion may found Section 4.3.1 (Lachin 2000), (Landis et al. 2005), (Somes O’Brien 2006) 2.","code":"RRmh(cbind(y, n) ~ tx + cluster(clus), Table6,      compare = c(\"a\", \"b\"), pf = FALSE) ##  ## RR  ## 95% interval estimates ##  ##   RR   LL   UL  ## 2.67 1.37 5.23 # Data matrix input: RRmh(Y = table6, pf = F)"},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"examples","dir":"Articles","previous_headings":"3 Stratified designs","what":"Examples","title":"PF Vignette","text":"fuller set examples, see vignette Examples Stratified Designs.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"logistic-regression-estimates","dir":"Articles","previous_headings":"4 Model based intervals","what":"Logistic regression estimates","title":"PF Vignette","text":"Intervals may estimated logistic regression models RRor(). takes fit glm() object estimates intervals delta method.","code":"bird.fit <- glm(cbind(y, n - y) ~ tx - 1, binomial, bird) RRor(bird.fit) ##  ## 95% t intervals on 4 df ##  ## PF  ##      PF      LL      UL  ##  0.5000 -0.0406  0.7598  ##  ##       mu.hat    LL    UL ## txcon  0.733 0.896 0.466 ## txvac  0.367 0.624 0.168"},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"estimating-the-dispersion-parameter","dir":"Articles","previous_headings":"4 Model based intervals","what":"Estimating the dispersion parameter","title":"PF Vignette","text":"binomial GLM weights \\[\\frac{\\hat{\\pi }(1-\\hat{\\pi })}{(\\hat{\\varphi })/n\\;}\\] \\((\\hat{\\varphi })\\) function dispersion parameter.","code":""},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"dispersion-parameter-varphi","dir":"Articles","previous_headings":"4 Model based intervals > 4.2 Estimating the dispersion parameter","what":"Dispersion parameter \\(\\varphi\\)","title":"PF Vignette","text":"simple estimator dispersion parameter, \\(\\varphi\\), may estimated method moments [Wed74]. given phiWt(). form dispersion parameter \\((\\varphi)=\\varphi\\), \\(\\varphi\\) estimated \\({X^2}/{df}\\;\\), Pearson statistic divided degrees freedom. Note \\(\\varphi\\) estimator may obtained quasibinomial family glm() , fact, used phiWt() reweight original fit: phiWt() makes easy estimate PF intervals single command. also allows different estimates \\({\\hat{\\varphi}}\\) specified subsets data. want subtract degree freedom additional parameter, can entering degrees freedom argument RRor().","code":"phiWt(bird.fit, fit.only = FALSE)$phi ##      all  ## 2.471592 summary(update(bird.fit, family = quasibinomial))$disp ## [1] 2.471592 # model weighted by phi hat RRor(phiWt(bird.fit)) ##  ## 95% t intervals on 4 df ##  ## PF  ##     PF     LL     UL  ##  0.500 -0.583  0.842  ##  ##       mu.hat    LL     UL ## txcon  0.733 0.943 0.3121 ## txvac  0.367 0.752 0.0997 # model with separate phi for vaccinates and controls RRor(phiWt(bird.fit, subset.factor = bird$tx)) ##  ## 95% t intervals on 4 df ##  ## PF  ##     PF     LL     UL  ##  0.500 -0.645  0.848  ##  ##       mu.hat    LL     UL ## txcon  0.733 0.938 0.3330 ## txvac  0.367 0.767 0.0925 # subtract 2 degrees of freedom RRor(phiWt(bird.fit, subset.factor = bird$tx), degf = 2) ##  ## 95% t intervals on 2 df ##  ## PF  ##     PF     LL     UL  ##  0.500 -2.164  0.921  ##  ##       mu.hat    LL     UL ## txcon  0.733 0.975 0.1635 ## txvac  0.367 0.895 0.0377"},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"dispersion-parameter-tau","dir":"Articles","previous_headings":"4 Model based intervals > 4.2 Estimating the dispersion parameter","what":"Dispersion parameter \\(\\tau\\)","title":"PF Vignette","text":"overdispersion due intra-cluster correlation, may make sense estimate dispersion function intra-cluster correlation parameter \\(\\tau\\). words, \\({({\\varphi }_{ij})}=1+{{\\tau }_{j}}({{n}_{ij}}-1)\\). tauWt() using Williams procedure (Williams 1982). example tauWt() estimates phiWt() estimates. cluster sizes . Let’s see happens modify bird data set. birdm data set cluster fractions differing cluster sizes. Note increasing cluster size can make things worse intra-cluster correlation. Now let’s compare weights phiWt() tauWt() unequal cluster sizes. output , w represents \\(1/(\\hat{\\varphi })\\;\\) nw \\(n/(\\hat{\\varphi })\\;\\) Look last two rows. Note nw.phi directly proportional n within treatment group, nw.tau . intra-cluster correlation, increasing cluster size give corresponding increase information.","code":"# model weighted using tau hat RRor(tauWt(bird.fit, subset.factor = bird$tx)) ##  ## 95% t intervals on 4 df ##  ## PF  ##     PF     LL     UL  ##  0.500 -0.645  0.848  ##  ##       mu.hat    LL     UL ## txcon  0.733 0.938 0.3330 ## txvac  0.367 0.767 0.0925 # different cluster sizes, same cluster fractions birdm.fit <- glm(cbind(y, n - y) ~ tx - 1, binomial, birdm) RRor(tauWt(birdm.fit, subset.factor = birdm$tx)) ##  ## 95% t intervals on 4 df ##  ## PF  ##     PF     LL     UL  ##  0.490 -0.605  0.838  ##  ##       mu.hat    LL    UL ## txcon  0.737 0.942 0.328 ## txvac  0.376 0.764 0.101 # Compare phi and tau weights # phi.wts <- phiWt(birdm.fit, fit.only = FALSE, subset.factor = birdm$tx)$weights tau.wts <- tauWt(birdm.fit, fit.only = FALSE, subset.factor = birdm$tx)$weights w <- cbind(w.phi  = phi.wts,            w.tau  = tau.wts,            nw.phi = phi.wts * birdm$n,            nw.tau = tau.wts * birdm$n) print(cbind(birdm[, c(3, 1, 2)], round(w, 2)), row.names = FALSE) ##   tx  y  n w.phi w.tau nw.phi nw.tau ##  vac  1 10  0.32  0.35   3.20   3.55 ##  vac  8 20  0.32  0.21   6.40   4.13 ##  vac  9 15  0.32  0.26   4.80   3.92 ##  con  8 16  0.21  0.27   3.39   4.33 ##  con  8 10  0.21  0.38   2.12   3.82 ##  con 27 30  0.21  0.16   6.36   4.84"},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"rao-scott-weights","dir":"Articles","previous_headings":"4 Model based intervals","what":"Rao-Scott weights","title":"PF Vignette","text":"(Rao Scott 1992) give method weighting clustered binomial observations based variance inflation due clustering. relate approach concepts design effect effective sample size familiar survey sampling, illustrate use variety contexts. rsbWt() implements manner phiWt() tauWt(). general use, function rsb() just returns design effect estimates weights.","code":"# model weighted with Rao-Scott weights RRor(rsbWt(birdm.fit, subset.factor = birdm$tx)) ##  ## 95% t intervals on 4 df ##  ## PF  ##     PF     LL     UL  ##  0.479 -0.314  0.793  ##  ##       mu.hat    LL    UL ## txcon  0.768 0.960 0.311 ## txvac  0.400 0.717 0.149 # just the design effect estimates rsb(birdm$y, birdm$n)$d ##      all  ## 6.334514"},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"likelihood-based-intervals","dir":"Articles","previous_headings":"","what":"Likelihood based intervals","title":"PF Vignette","text":"RRlsi() function estimates likelihood support intervals RR profile likelihood Section 7.6 (Royall 1997). Likelihood support intervals usually formed based desired likelihood ratio, \\({1}/{k}\\;\\), often \\({1}/{8}\\;\\) \\({1}/{32}\\;\\). conditions log likelihood ratio may follow chi-square distribution. , \\(\\alpha =1-{{F}_{{{\\chi }^{2}}}}\\left( 2\\log (k),1 \\right)\\). RRsc() make conversion \\(\\alpha\\) \\(k\\) argument use.alpha = T.","code":"RRlsi(c(4, 24, 12, 28)) ##  ## 1/8 likelihood support interval for PF  ##  ## corresponds to 95.858% confidence ##   (under certain assumptions) ##  ## PF  ##     PF     LL     UL  ## 0.6111 0.0168 0.8859 RRlsi(c(4, 24, 12, 28), use.alpha = TRUE) ##  ## 1/6.826 likelihood support interval for PF  ##  ## corresponds to 95% confidence ##   (under certain assumptions) ##  ## PF  ##     PF     LL     UL  ## 0.6111 0.0495 0.8792"},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"incidence-ratio","dir":"Articles","previous_headings":"","what":"Incidence ratio","title":"PF Vignette","text":"incidence number cases per subject-time. distribution assumed Poisson. certain designs, incidence ratio (\\(IR\\)) used measure treatment effect. Correspondingly, \\({{PF}_{IR}}=1-IR\\) used measure effect intervention preventive, vaccination. \\(IR\\) also called incidence density ratio (\\(IDR\\)), term used following functions.","code":""},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"score-method","dir":"Articles","previous_headings":"6 Incidence ratio","what":"Score method","title":"PF Vignette","text":"IDRsc() estimates confidence interval incidence density ratio using Siev’s formula Appendix 1 (Siev 1994) based Poisson score statistic3. \\[IDR=\\widehat{IDR}\\left\\{ 1+\\left( \\frac{1}{{{y}_{1}}}+\\frac{1}{{{y}_{2}}} \\right)\\frac{z_{\\alpha /2}^{2}}{2}\\ \\ \\pm \\ \\ \\frac{z_{\\alpha /2}^{2}}{2{{y}_{1}}{{y}_{2}}}\\sqrt{{{y}_{\\bullet }}\\left( {{y}_{\\bullet }}z_{\\alpha /2}^{2}+4{{y}_{1}}{{y}_{2}} \\right)} \\right\\}\\]","code":"IDRsc(c(26, 204, 10, 205), pf = FALSE) ##  ## IDR  ## 95% interval estimates ##  ##  IDR   LL   UL  ## 2.61 1.28 5.34"},{"path":"https://abs-dev.github.io/PF/articles/PFvignette.html","id":"likelihood-method","dir":"Articles","previous_headings":"6 Incidence ratio","what":"Likelihood method","title":"PF Vignette","text":"likelihood support interval \\(IDR\\) may estimated based orthogonal factoring reparameterized likelihood. Section 7.2 (Royall 1997) IDRlsi() implements method. Likelihood support intervals usually formed based desired likelihood ratio, \\({1}/{k}\\;\\), often \\({1}/{8}\\;\\) \\({1}/{32}\\;\\). conditions log likelihood ratio may follow chi square distribution. , \\(\\alpha =1-{{F}_{{{\\chi }^{2}}}}\\left( 2\\log (k),1 \\right)\\). IDRlsi() make conversion \\(\\alpha\\) tp \\(k\\) argument use.alpha = T.","code":"IDRlsi(c(26, 204, 10, 205), pf = FALSE) ##  ## 1/8 likelihood support interval for IDR  ##  ## corresponds to 95.858% confidence ##   (under certain assumptions) ##  ## IDR  ##  IDR   LL   UL  ## 2.61 1.26 5.88 IDRlsi(c(26, 204, 10, 205), pf = FALSE, use.alpha = TRUE) ##  ## 1/6.826 likelihood support interval for IDR  ##  ## corresponds to 95% confidence ##   (under certain assumptions) ##  ## IDR  ##  IDR   LL   UL  ## 2.61 1.30 5.69"},{"path":[]},{"path":"https://abs-dev.github.io/PF/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"CVB Statistics. Maintainer, former owner. David Siev. Author.           2019 Marie Vendettuoli. Author.           2019 Thomas Kent. Author.           starting 2020","code":""},{"path":"https://abs-dev.github.io/PF/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Siev D, Vendettuoli M, Kent T (2026). PF: Prevented fraction. R package version 9.6.10, https://github.com/ABS-dev/PF/.","code":"@Manual{,   title = {PF: Prevented fraction},   author = {David Siev and Marie Vendettuoli and Thomas Kent},   year = {2026},   note = {R package version 9.6.10},   url = {https://github.com/ABS-dev/PF/}, }"},{"path":[]},{"path":"https://abs-dev.github.io/PF/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Prevented fraction","text":"","code":"devtools::install_github(\"ABS-dev/PF\")"},{"path":"https://abs-dev.github.io/PF/index.html","id":"vignettes","dir":"","previous_headings":"","what":"Vignettes","title":"Prevented fraction","text":"package contains following manuals vignettes: PF Package PF Vignette","code":""},{"path":"https://abs-dev.github.io/PF/index.html","id":"issues","dir":"","previous_headings":"","what":"Issues","title":"Prevented fraction","text":"Report issues requests package issues page.","code":""},{"path":"https://abs-dev.github.io/PF/reference/bird.html","id":null,"dir":"Reference","previous_headings":"","what":"bird dataset — bird","title":"bird dataset — bird","text":"bird dataset","code":""},{"path":"https://abs-dev.github.io/PF/reference/bird.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"bird dataset — bird","text":"data.frame 6 observations following 4 variables, NAs y: number positive n: total number group tx x tx: treatment \"vac\" \"con\" : ?","code":""},{"path":"https://abs-dev.github.io/PF/reference/bird.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"bird dataset — bird","text":"need references","code":""},{"path":"https://abs-dev.github.io/PF/reference/birdm.html","id":null,"dir":"Reference","previous_headings":"","what":"birdm dataset — birdm","title":"birdm dataset — birdm","text":"birdm dataset","code":""},{"path":"https://abs-dev.github.io/PF/reference/birdm.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"birdm dataset — birdm","text":"data.frame 6 observations following 4 variables, NAs y: number positive n: total number group tx x tx: treatment \"vac\" \"con\" : ?","code":""},{"path":"https://abs-dev.github.io/PF/reference/birdm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"birdm dataset — birdm","text":"need references","code":""},{"path":"https://abs-dev.github.io/PF/reference/dfSet1.html","id":null,"dir":"Reference","previous_headings":"","what":"Set1 dataset — Set1","title":"Set1 dataset — Set1","text":"Set1 dataset","code":""},{"path":"https://abs-dev.github.io/PF/reference/dfSet1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Set1 dataset — Set1","text":"data.frame 6 observation following 4 variables, NAs y: number positive n: total number group tx x clus tx: treatment \"vac\" \"con\" clus: cluster ID","code":""},{"path":"https://abs-dev.github.io/PF/reference/dfSet1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Set1 dataset — Set1","text":"need references","code":""},{"path":"https://abs-dev.github.io/PF/reference/dfTable6.html","id":null,"dir":"Reference","previous_headings":"","what":"Table6 dataset — Table6","title":"Table6 dataset — Table6","text":"Table6 dataset","code":""},{"path":"https://abs-dev.github.io/PF/reference/dfTable6.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Table6 dataset — Table6","text":"data.frame 8 observations following 4 variables, NAs y: number positive n: total number group tx x clus tx: treatment \"\" \"b\" clus: cluster ID","code":""},{"path":"https://abs-dev.github.io/PF/reference/dfTable6.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Table6 dataset — Table6","text":"Table 1 Gart (1985)","code":""},{"path":"https://abs-dev.github.io/PF/reference/dot-rr.score.asymp.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal function. — .rr.score.asymp","title":"Internal function. — .rr.score.asymp","text":"Internal function.","code":""},{"path":"https://abs-dev.github.io/PF/reference/dot-rr.score.asymp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal function. — .rr.score.asymp","text":"","code":".rr.score.asymp(y, alpha = 0.05, iter.max = 18, converge = 1e-04, mn = FALSE)"},{"path":"https://abs-dev.github.io/PF/reference/dot-rr.score.asymp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal function. — .rr.score.asymp","text":"y data alpha alpha iter.max maximum number iterations converge convergence criterion mn boolean whether calculate MN use default value 1.0","code":""},{"path":"https://abs-dev.github.io/PF/reference/dot-rr.score.asymp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Internal function. — .rr.score.asymp","text":"","code":".rr.score.asymp(c(0, 18, 16, 19), mn = FALSE) #>     point        LL        UL  #> 0.0000000 0.0000000 0.2105332  .rr.score.asymp(c(0, 18, 16, 19), mn = TRUE) #>     point        LL        UL  #> 0.0000000 0.0000000 0.2154228"},{"path":"https://abs-dev.github.io/PF/reference/IDRlsi.html","id":null,"dir":"Reference","previous_headings":"","what":"IDR likelihood support interval. — IDRlsi","title":"IDR likelihood support interval. — IDRlsi","text":"Estimates likelihood support interval incidence density ratio prevented fraction based .","code":""},{"path":"https://abs-dev.github.io/PF/reference/IDRlsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IDR likelihood support interval. — IDRlsi","text":"","code":"IDRlsi(   y = NULL,   formula = NULL,   data = NULL,   alpha = 0.05,   k = 8,   use.alpha = FALSE,   pf = TRUE,   converge = 1e-08,   rnd = 3,   start = NULL,   trace.it = FALSE,   iter.max = 24,   compare = c(\"con\", \"vac\") )"},{"path":"https://abs-dev.github.io/PF/reference/IDRlsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"IDR likelihood support interval. — IDRlsi","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference). formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment. data data.frame containing variables formula. alpha Complement confidence level. k Likelihood ratio criterion. use.alpha Base choice k relationship alpha? pf Estimate IDR complement PF? converge Convergence criterion rnd Number digits rounding. Affects display , estimates. start describe . trace.Verbose tracking iterations? iter.max Maximum number iterations compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared.","code":""},{"path":"https://abs-dev.github.io/PF/reference/IDRlsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"IDR likelihood support interval. — IDRlsi","text":"rrsi object following elements. estimate: vector point interval estimate estimator: either PF IDR y: data.frame \"y1\", \"n1\", \"y2\", \"n2\" values. k: Likelihood ratio criterion rnd: many digits round display alpha: complement confidence level","code":""},{"path":"https://abs-dev.github.io/PF/reference/IDRlsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"IDR likelihood support interval. — IDRlsi","text":"Estimates likelihood support interval incidence density ratio based orthogonal factoring reparameterized likelihood. incidence density number cases per subject-time; distribution assumed Poisson. Likelihood support intervals usually formed based desired likelihood ratio, often 1 / 8 1 / 32. conditions log likelihood ratio may follow chi square distribution. , \\(\\alpha = 1 - F(2log(k), 1)\\), \\(F\\) chi-square CDF. use.alpha = TRUE``RRsc() make conversion \\(\\alpha\\) \\(k\\) . data may also matrix, case y entered matrix(c(y1, n1 - y1, y2, n2 - y2), 2, 2, byrow = TRUE).","code":""},{"path":"https://abs-dev.github.io/PF/reference/IDRlsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"IDR likelihood support interval. — IDRlsi","text":"Royall R. Statistical Evidence: Likelihood Paradigm. Chapman & Hall, Boca Raton, 1997. Section 7.2.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/IDRlsi.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"IDR likelihood support interval. — IDRlsi","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/IDRlsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"IDR likelihood support interval. — IDRlsi","text":"","code":"# Both examples represent the same observation, with data entry by vector # and matrix notation.  y_vector <- c(26, 204, 10, 205) IDRlsi(y_vector, pf = FALSE) #>  #> 1/8 likelihood support interval for IDR  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> IDR  #>  IDR   LL   UL  #> 2.61 1.26 5.88  #>   # 1 / 8 likelihood support interval for IDR  # corresponds to 95.858% confidence #   (under certain assumptions)  # IDR #  IDR   LL   UL # 2.61 1.26 5.88  y_matrix <- matrix(c(26, 178, 10, 195), 2, 2, byrow = TRUE) y_matrix #>      [,1] [,2] #> [1,]   26  178 #> [2,]   10  195 #      [, 1] [, 2] # [1, ]   26  178 # [2, ]   10  195  IDRlsi(y_matrix, pf = FALSE) #>  #> 1/8 likelihood support interval for IDR  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> IDR  #>  IDR   LL   UL  #> 2.61 1.26 5.88  #>   # 1 / 8 likelihood support interval for IDR  # corresponds to 95.858% confidence #   (under certain assumptions)  # IDR #  IDR   LL   UL # 2.61 1.26 5.88  data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 5),              n = c(rep(41, 4), 40, rep(41, 5)),              y = c(4, 5, 7, 6, 4, 1, 3, 3, 2, 1),              cage = rep(paste(\"cage\", 1:5), 2)) IDRlsi(data = data1, formula = cbind(y, n) ~ group,                compare = c(\"treated\", \"control\"), pf = FALSE) #> 'y' and 'n' values will be summed by treated and control designation in datacolumn group #>  #> 1/8 likelihood support interval for IDR  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> IDR  #>  IDR   LL   UL  #> 2.61 1.26 5.88  #>   # 1 / 8 likelihood support interval for IDR  # corresponds to 95.858% confidence #   (under certain assumptions)  # IDR #  IDR   LL   UL # 2.61 1.26 5.88  require(dplyr) #> Loading required package: dplyr #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),     sum_n = sum(n))  IDRlsi(data = data2, formula = cbind(sum_y, sum_n) ~ group,                compare = c(\"treated\", \"control\"), pf = FALSE) #>  #> 1/8 likelihood support interval for IDR  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> IDR  #>  IDR   LL   UL  #> 2.61 1.26 5.88  #>   # 1 / 8 likelihood support interval for IDR  # corresponds to 95.858% confidence #   (under certain assumptions)  # IDR #  IDR   LL   UL # 2.61 1.26 5.88"},{"path":"https://abs-dev.github.io/PF/reference/IDRsc.html","id":null,"dir":"Reference","previous_headings":"","what":"IDR confidence interval. — IDRsc","title":"IDR confidence interval. — IDRsc","text":"Estimates confidence interval incidence density ratio prevented fraction based .","code":""},{"path":"https://abs-dev.github.io/PF/reference/IDRsc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IDR confidence interval. — IDRsc","text":"","code":"IDRsc(   y = NULL,   data = NULL,   formula = NULL,   compare = c(\"con\", \"vac\"),   alpha = 0.05,   pf = TRUE,   rnd = 3 )"},{"path":"https://abs-dev.github.io/PF/reference/IDRsc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"IDR confidence interval. — IDRsc","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference). data data.frame containing variables formula. formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment. compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. alpha Complement confidence level. pf Estimate IDR, complement PF? rnd Number digits rounding. Affects display , estimates.","code":""},{"path":"https://abs-dev.github.io/PF/reference/IDRsc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"IDR confidence interval. — IDRsc","text":"rr1 object following elements. estimate: vector point interval estimate estimator: either PF IDR y: data vector rnd: many digits round display alpha: complement confidence level","code":""},{"path":"https://abs-dev.github.io/PF/reference/IDRsc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"IDR confidence interval. — IDRsc","text":"incidence density number cases per subject-time; distribution assumed Poisson. IDRsc estimates confidence interval incidence density ratio using Siev's formula based Poisson score statistic. \\( IDR = \\widehat{IDR}\\left\\{ 1 + \\left(   \\frac{1}{{{y}_{1}}} + \\frac{1}{{{y}_{2}}}   \\right)\\frac{z_{\\alpha / 2}^{2}}{2}\\   \\ \\pm \\ \\ \\frac{z_{\\alpha / 2}^{2}}{2{{y}_{1}}{{y}_{2}}}\\sqrt{{{y}_{\\bullet   }}\\left( {{y}_{\\bullet }}z_{\\alpha / 2}^{2} + 4{{y}_{1}}{{y}_{2}} \\right)}   \\right\\} \\) data may also matrix. case y entered matrix(c(y1, n1 - y1, y2, n2 - y2), 2, 2, byrow = TRUE).","code":""},{"path":"https://abs-dev.github.io/PF/reference/IDRsc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"IDR confidence interval. — IDRsc","text":"Siev D, 1994. Estimating vaccine efficacy prospective studies. Preventive Veterinary Medicine 20:279-296, Appendix 1. Graham PL, Mengersen K, Morton AP, 2003. Confidence limits ratio two rates based likelihood scores:non-iterative method Statistics Medicine 22:2071-2083. Siev D, 2004. Letter editor. Statistics Medicine 23:693. (Typographical error formula: replace two final minus signs subscript dots.)","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/IDRsc.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"IDR confidence interval. — IDRsc","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/IDRsc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"IDR confidence interval. — IDRsc","text":"","code":"# All examples represent the same observation, with data entry by vector, # matrix, and formula+data notation.  y_vector <- c(26, 204, 10, 205) IDRsc(y_vector, pf = FALSE) #>  #> IDR  #> 95% interval estimates #>  #>  IDR   LL   UL  #> 2.61 1.28 5.34  #>   # IDR # 95% interval estimates  #  IDR   LL   UL # 2.61 1.28 5.34  y_matrix <- matrix(c(26, 178, 10, 195), 2, 2, byrow = TRUE) y_matrix #>      [,1] [,2] #> [1,]   26  178 #> [2,]   10  195 #      [, 1] [, 2] # [1, ]   26  178 # [2, ]   10  195  IDRsc(y_matrix, pf = FALSE) #>  #> IDR  #> 95% interval estimates #>  #>  IDR   LL   UL  #> 2.61 1.28 5.34  #>   # IDR # 95% interval estimates  #  IDR   LL   UL # 2.61 1.28 5.34  require(dplyr) data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 5),             n = c(rep(41, 4), 40, rep(41, 5)),             y = c(4, 5, 7, 6, 4, 1, 3, 3, 2, 1),             cage = rep(paste(\"cage\", 1:5), 2)) data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),   sum_n = sum(n)) IDRsc(data = data2, formula =  cbind(sum_y, sum_n) ~ group,     compare = c(\"treated\", \"control\"), pf = FALSE) #>  #> IDR  #> 95% interval estimates #>  #>  IDR   LL   UL  #> 2.61 1.28 5.34  #>   # IDR # 95% interval estimates  #  IDR   LL   UL # 2.61 1.28 5.34"},{"path":"https://abs-dev.github.io/PF/reference/New.html","id":null,"dir":"Reference","previous_headings":"","what":"New dataset — New","title":"New dataset — New","text":"New dataset","code":""},{"path":"https://abs-dev.github.io/PF/reference/New.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"New dataset — New","text":"data frame 52 observations following 3 variables, NAs cage: cage ID. 1 - 26 tx: treatment. one \"con\" \"vac\" pos: numeric indicator positive response. 0 = FALSE 1 = TRUE","code":""},{"path":"https://abs-dev.github.io/PF/reference/New.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"New dataset — New","text":"need references","code":""},{"path":"https://abs-dev.github.io/PF/reference/PF-package.html","id":null,"dir":"Reference","previous_headings":"","what":"PF: Prevented fraction — PF-package","title":"PF: Prevented fraction — PF-package","text":"Functions related PF (prevented fraction). Calculate incidence density ratio, confidence interval, Rao-Scott weights PF multiple methods. See http://goo.gl/eJ6Rxi definition PF. endorsement, claim, warranty implied package. made available investigational pedagogical use . See https://www.aphis.usda.gov/animal_health/vet_biologics/publications/STATWI0007.pdf futher details.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/PF-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"PF: Prevented fraction — PF-package","text":"Maintainer: CVB Statistics CVB.Data.Help@usda.gov [former owner] Authors: David Siev (2019) Marie Vendettuoli (2019) Thomas Kent (starting 2020)","code":""},{"path":"https://abs-dev.github.io/PF/reference/phiWt.html","id":null,"dir":"Reference","previous_headings":"","what":"Binomial dispersion parameter. — phiWt","title":"Binomial dispersion parameter. — phiWt","text":"MME estimate dispersion parameter phi.","code":""},{"path":"https://abs-dev.github.io/PF/reference/phiWt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Binomial dispersion parameter. — phiWt","text":"","code":"phiWt(fit, subset.factor = NULL, fit.only = TRUE, show.warns = FALSE)"},{"path":"https://abs-dev.github.io/PF/reference/phiWt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Binomial dispersion parameter. — phiWt","text":"fit glm object. subset.factor Factor estimating phi subset.  converted factor factor. fit.Return new fit?  FALSE, also returns weights phi estimates. show.warns Show warnings","code":""},{"path":"https://abs-dev.github.io/PF/reference/phiWt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Binomial dispersion parameter. — phiWt","text":"list following elements. fit: new model fit, updated estimated weights weights: vector weights phi: vector phi estimates","code":""},{"path":"https://abs-dev.github.io/PF/reference/phiWt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Binomial dispersion parameter. — phiWt","text":"Estimates binomial dispersion parameter \\(\\phi\\) method moments. Refits model, weighting observations \\(1/\\phi\\). Uses quasibinomial family glm().","code":""},{"path":"https://abs-dev.github.io/PF/reference/phiWt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Binomial dispersion parameter. — phiWt","text":"Wedderburn RWM, 1974. Quasi-likelihood functions, generalized linear models, Gauss-Newton method. Biometrika 61:439-447.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/phiWt.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Binomial dispersion parameter. — phiWt","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/phiWt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Binomial dispersion parameter. — phiWt","text":"","code":"birdm.fit <- glm(cbind(y, n - y) ~ tx-1, binomial, birdm) RRor(phiWt(birdm.fit)) #>  #> 95% t intervals on 4 df #>  #> PF  #>     PF     LL     UL  #>  0.479 -0.537  0.823  #>  #>       mu.hat   LL    UL #> txcon  0.768 0.95 0.367 #> txvac  0.400 0.78 0.111 # # 95% t intervals on 4 df # # PF #     PF     LL     UL #  0.479 -0.537  0.823 # #       mu.hat   LL    UL # txcon  0.768 0.95 0.367 # txvac  0.400 0.78 0.111 #"},{"path":"https://abs-dev.github.io/PF/reference/print.PF.html","id":null,"dir":"Reference","previous_headings":"","what":"Print values for PF data obhects. — print.rr1","title":"Print values for PF data obhects. — print.rr1","text":"Print values PF data obhects.","code":""},{"path":"https://abs-dev.github.io/PF/reference/print.PF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print values for PF data obhects. — print.rr1","text":"","code":"# S3 method for class 'rr1' print(x, ...)  # S3 method for class 'rror' print(x, ...)  # S3 method for class 'rrsi' print(x, ...)  # S3 method for class 'rrmp' print(x, ...)  # S3 method for class 'rrsc' print(x, ...)  # S3 method for class 'rrstr' print(x, ...)"},{"path":"https://abs-dev.github.io/PF/reference/print.PF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print values for PF data obhects. — print.rr1","text":"x object class rr1, rror, rrsi, rrmp, rrstr, rrsc ... arguments used method","code":""},{"path":"https://abs-dev.github.io/PF/reference/rat.html","id":null,"dir":"Reference","previous_headings":"","what":"rat dataset — rat","title":"rat dataset — rat","text":"rat dataset","code":""},{"path":"https://abs-dev.github.io/PF/reference/rat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"rat dataset — rat","text":"data.frame 32 observations following 3 variables, NAs y: number positive n: total number group: treatment group: \"control\" \"treated\"","code":""},{"path":"https://abs-dev.github.io/PF/reference/rat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"rat dataset — rat","text":"Weil's rat data (Table 1 Rao Scott)","code":""},{"path":"https://abs-dev.github.io/PF/reference/rr1-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rr1 — rr1-class","title":"Data class rr1 — rr1-class","text":"Data class rr1","code":""},{"path":"https://abs-dev.github.io/PF/reference/rr1-class.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rr1 — rr1-class","text":"estimate:   vector point interval estimate estimator:   either \"PF\" \"IDR\" Y: data.frame restructured input rnd: many digits round display alpha: complement c..","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/rr1-class.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rr1 — rr1-class","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRlsi.html","id":null,"dir":"Reference","previous_headings":"","what":"RR likelihood support interval. — RRlsi","title":"RR likelihood support interval. — RRlsi","text":"likelihood support interval risk ratio prevented fraction likelihood profile.","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRlsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RR likelihood support interval. — RRlsi","text":"","code":"RRlsi(   y = NULL,   formula = NULL,   data = NULL,   compare = c(\"vac\", \"con\"),   alpha = 0.05,   k = 8,   use.alpha = FALSE,   pf = TRUE,   iter.max = 50,   converge = 1e-06,   rnd = 3,   start = NULL,   track = FALSE,   full.track = FALSE )"},{"path":"https://abs-dev.github.io/PF/reference/RRlsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RR likelihood support interval. — RRlsi","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference group). formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment. data data.frame containing variables formula. compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. alpha Complement confidence level (see details). k Likelihood ratio criterion. use.alpha Base choice k relationship alpha? pf Estimate RR complement PF? iter.max Maximum number iterations converge Convergence criterion rnd Number digits rounding. Affects display onlyRR, estimates. start Optional starting value. track Verbose tracking iterations? full.track Verbose tracking iterations?","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRlsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RR likelihood support interval. — RRlsi","text":"object class rrsi following fields: estimate: matrix point interval estimates - see details estimator: either \"PF\" \"RR\" y: data.frame \"y1\", \"n1\", \"y2\", \"n2\" values. rnd: many digits round display k: likelihood ratio criterion alpha: complement confidence level","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRlsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"RR likelihood support interval. — RRlsi","text":"Estimates likelihood support interval RR PF profile likelihood method using DUD algorithm. Likelihood support intervals usually formed based desired likelihood ratio, often 1 / 8 1 / 32. conditions log likelihood ratio may follow chi square distribution. , \\(\\alpha = 1 - F(2log(k), 1)\\), \\(F\\) chi-square CDF. use.alpha = TRUE,  RRlsi() make conversion \\(\\alpha\\) \\(k\\) data may also matrix. case Y entered matrix(c(y1, n1-y1, y2, n2-y2), 2, 2, byrow = TRUE).","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRlsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"RR likelihood support interval. — RRlsi","text":"Royall R. Statistical Evidence: Likelihood Paradigm. Chapman & Hall, Boca Raton, 1997.  Section 7.6 Ralston ML, Jennrich RI, 1978. DUD, Derivative-Free Algorithm Nonlinear Least Squares. Technometrics 20:7-14.","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRlsi.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"RR likelihood support interval. — RRlsi","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRlsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RR likelihood support interval. — RRlsi","text":"","code":"# All examples represent the same observation, with data entry by vector, # matrix, and formula+data notation.  y_vector <- c(4, 24, 12, 28) RRlsi(y_vector) #>  #> 1/8 likelihood support interval for PF  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> PF  #>     PF     LL     UL  #> 0.6111 0.0168 0.8859  #>   # 1 / 8 likelihood support interval for PF  # corresponds to 95.858% confidence #   (under certain assumptions)  # PF #     PF     LL     UL # 0.6111 0.0168 0.8859  y_matrix <- matrix(c(4, 20, 12, 16), 2, 2, byrow = TRUE) y_matrix #>      [,1] [,2] #> [1,]    4   20 #> [2,]   12   16 #      [, 1] [, 2] # [1, ]    4   20 # [2, ]   12   16  RRlsi(y_matrix) #>  #> 1/8 likelihood support interval for PF  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> PF  #>     PF     LL     UL  #> 0.6111 0.0168 0.8859  #>   # 1 / 8 likelihood support interval for PF  # corresponds to 95.858% confidence #   (under certain assumptions)  # PF #     PF     LL     UL # 0.6111 0.0168 0.8859  require(dplyr) data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 2),   y = c(1, 3, 7, 5),   n = c(12, 12, 14, 14),   cage = rep(paste(\"cage\", 1:2), 2))  data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),     sum_n = sum(n)) RRlsi(data = data2, formula =  cbind(sum_y, sum_n) ~ group,    compare = c(\"treated\", \"control\")) #>  #> 1/8 likelihood support interval for PF  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> PF  #>     PF     LL     UL  #> 0.6111 0.0168 0.8859  #>   # 1 / 8 likelihood support interval for PF # # corresponds to 95.858% confidence # (under certain assumptions) # # PF # PF     LL     UL # 0.6111 0.0168 0.8859"},{"path":"https://abs-dev.github.io/PF/reference/RRmh.html","id":null,"dir":"Reference","previous_headings":"","what":"Mantel-Haenszel method, CI for common RR over strata or clusters with sparse data. — RRmh","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with sparse data. — RRmh","text":"Estimates confidence intervals risk ratio prevented fraction clustered stratified data, using Mantel-Haenszel estimator sparse data.","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with sparse data. — RRmh","text":"","code":"RRmh(   formula = NULL,   data = NULL,   compare = c(\"vac\", \"con\"),   Y,   alpha = 0.05,   pf = TRUE,   rnd = 3 )"},{"path":"https://abs-dev.github.io/PF/reference/RRmh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with sparse data. — RRmh","text":"formula Formula form cbind(y, n) ~ x + cluster(w), Y number positive, n group size, x factor two levels treatment, w factor indicating clusters. data data.frame containing variables formula compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. Y Matrix data, \\(K \\times 4\\). row stratum cluster. columns \\(y1, n1, y2, n2\\), y's number positive group, n total group. Group 1 corresponds vaccinates group 2 controls reference. data entered formula dataframe, Y generated automatically. alpha Complement confidence level. pf Estimate RR complement PF? rnd Number digits rounding. Affects display , estimates.","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmh.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with sparse data. — RRmh","text":"object class rr1  following fields. estimate: vector point interval estimates:  point estimate, lower confidence limit, upper confidence limit estimator: either \"PF\" \"RR\" y: data.frame restructured input rnd: many digits round display alpha: complement confidence level","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmh.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with sparse data. — RRmh","text":"Based Mantel-Haenszel (1959) procedure sparse data developed Greenland Robins (1985). confidence limits based asymptotic normality log(risk ratio).  Agresti Hartzel (2000) favor procedure small, sparse data sets, warn less efficient maximum likelihood large data sets.","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmh.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with sparse data. — RRmh","text":"either y1's y2's zero, division zero may occur, NaN returned values. Vignette Examples Stratified Designs forthcoming examples. Call function may one two formats: (1) specify data formula (2) matrix Y RRmh(formula, data, compare = c(\"b\", \"\"), pf = TRUE, alpha = 0.05, rnd = 3) RRmh(Y, pf = TRUE, alpha = 0.05, rnd = 3)","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmh.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with sparse data. — RRmh","text":"Mantel N, Haenszel W, 1959.  Statistical aspects analysis data retrospective studies disease. Journal National Cancer Institute 22:719-748. Greenland S, Robins JM, 1985.  Estimation common effect parameter sparse follow-data. Biometrics  41:  55-68.  Errata, 45: 1323-1324. Agresti , Hartzel J, 2000.  Strategies comparing treatments binary response multi-centre data.  Statistics Medicine  19: 1115-1139. Lachin JM, 2000.  Biostatistical Methods:  Assessment Relative Risks (Wiley, New York), Sec. 4.3.1.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/RRmh.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with sparse data. — RRmh","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmh.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with sparse data. — RRmh","text":"","code":"## Table 1 from Gart (1985) ##  as data frame  # tx group \"b\" is control RRmh(cbind(y, n) ~ tx + cluster(clus),      Table6,      compare = c(\"a\", \"b\"), pf = FALSE) #>  #> RR  #> 95% interval estimates #>  #>   RR   LL   UL  #> 2.67 1.37 5.23  #>   # RR # 95% interval estimates # #   RR   LL   UL # 2.67 1.37 5.23 #  ## or as matrix RRmh(Y = table6, pf = FALSE) #>  #> RR  #> 95% interval estimates #>  #>   RR   LL   UL  #> 2.67 1.37 5.23  #>   # RR # 95% interval estimates # #   RR   LL   UL # 2.67 1.37 5.23"},{"path":"https://abs-dev.github.io/PF/reference/rrmp.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rrmp — rrmp-class","title":"Data class rrmp — rrmp-class","text":"data class rrmp","code":""},{"path":"https://abs-dev.github.io/PF/reference/rrmp.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rrmp — rrmp-class","text":"estimate:  vector point interval estimate estimator:  either \"PF\" \"IDR\" Y:  data vector rnd:  many digits round display alpha:  complement c.. compare:  text vector, input multvec:  data.frame showing multinomial representation data","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/rrmp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rrmp — rrmp-class","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmpWald.html","id":null,"dir":"Reference","previous_headings":"","what":"Wald confidence intervals for RR from matched pairs — RRmpWald","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"Estimates confidence intervals risk ratio prevented fraction matched pairs.","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmpWald.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"","code":"RRmpWald(   formula = NULL,   data = NULL,   compare = c(\"vac\", \"con\"),   affected = 1,   x,   alpha = 0.05,   pf = TRUE,   tdist = TRUE,   df = NULL,   rnd = 3 )"},{"path":"https://abs-dev.github.io/PF/reference/RRmpWald.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"formula Formula form y ~ x + cluster(w), y indicator individual's positive response, x factor two levels treatment, w identifies pairs. data data.frame containing variables formula compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. affected Indicator positive response x Alternative data input. Instead formula data frame, data may input frequency vector. See example order vector. alpha Complement confidence level pf Estimate RR complement PF? tdist Use t distribution? df Degrees freedom. NULL, function default `df = N 2`, N total number pairs. rnd Number digits rounding. Affects display , estimates.","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmpWald.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"rrmp object following fields: estimate: vector point interval estimates - see details estimator: either \"PF\" \"RR\" compare: text vector, input alpha: complement confidence level rnd: many digits round display multvec: data frame showing multinomial representation data","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmpWald.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"Estimates confidence intervals risk ratio prevented fraction matched pairs. response tetranomial vector c(11, 12, 21, 22), first index row second index column displayed 2x2 table. Wald type confidence intervals found applying delta method multinomial variance. method fails responders one treatment groups. Alternative forms data entry illustrated output, say Y, c(Y$xtable) = Y$freqvec = Y$multvec$Freq. RR = 0 (PF = 1), function return degenerate interval.","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmpWald.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"Experimental functions estimating profile likelihood intervals CVBmisc package. Call function may one two formats: (1) specify data formula (2) vector x RRmpWald(formula, data, compare = c(\"vac\", \"con\"), affected = 1, alpha = 0.05, pf = TRUE, tdist = TRUE, df = NULL, rnd = 3) RRmpWald(x, compare = c(\"vac\", \"con\"), affected = 1, alpha = 0, 05, pf = TRUE, tdist = TRUE, df = NULL, rnd = 3)","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmpWald.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRmpWald.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"","code":"RRmpWald(pos ~ tx + cluster(cage), New, compare = c(\"vac\", \"con\")) #>  #> PF  #> 95% interval estimates #>  #>    PF    LL    UL  #> 0.550 0.183 0.752  #>   thistable <- New |>   tidyr::spread(tx, pos) |>   tidyr::drop_na() |>   dplyr::mutate(vac = factor(vac, levels = 1:0),     con = factor(con, levels = 1:0)) |>   with(table(vac, con)) thistable #>    con #> vac  1  0 #>   1  7  2 #>   0 13  4 as.vector(thistable) #> [1]  7 13  2  4  RRmpWald(x = as.vector(thistable)) #>  #> PF  #> 95% interval estimates #>  #>    PF    LL    UL  #> 0.550 0.183 0.752  #>"},{"path":"https://abs-dev.github.io/PF/reference/rrorclass.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rror — rror-class","title":"Data class rror — rror-class","text":"data class rror","code":""},{"path":"https://abs-dev.github.io/PF/reference/rrorclass.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rror — rror-class","text":"estimate:  vector point interval estimate estimator:  either \"PF\" \"IDR\" Y:  data vector rnd:  many digits round display alpha:  complement c.. norm:  logical indicating Gaussian t interval degf:  degrees freedom mu:  matrix rows giving probability estimates groups","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/rrorclass.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rror — rror-class","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRotsst.html","id":null,"dir":"Reference","previous_headings":"","what":"RR exact CI, OTSST method. — RRotsst","title":"RR exact CI, OTSST method. — RRotsst","text":"Estimates confidence interval risk ratio prevented fraction, exact method based score statistic (inverts one two-sided test).","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRotsst.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RR exact CI, OTSST method. — RRotsst","text":"","code":"RRotsst(   y = NULL,   data = NULL,   formula = NULL,   compare = c(\"vac\", \"con\"),   alpha = 0.05,   pf = TRUE,   stepstart = 0.1,   iter.max = 36,   converge = 1e-06,   rnd = 3,   trace.it = FALSE,   nuisance.points = 120,   gamma = 1e-06 )"},{"path":"https://abs-dev.github.io/PF/reference/RRotsst.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RR exact CI, OTSST method. — RRotsst","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference). data data.frame containing variables formula. formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment. compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. alpha Complement confidence level. pf Estimate RR complement PF? stepstart starting interval step search iter.max Maximum number iterations converge Convergence criterion rnd Number digits rounding. Affects display , estimates. trace.Verbose tracking iterations? nuisance.points number points evaluate nuisance parameter gamma parameter Berger-Boos correction (restricts range nuisance parameter evaluation)","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRotsst.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RR exact CI, OTSST method. — RRotsst","text":"object class rr1 following fields: estimate: vector point interval estimate estimator: either \"PF\" \"RR\" y: data.frame \"y1\", \"n1\", \"y2\", \"n2\" values. rnd: many digits round display alpha: complement confidence level","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRotsst.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"RR exact CI, OTSST method. — RRotsst","text":"Estimates confidence intervals based score statistic 'exact' sense accounting discreteness. score statistic used select tail area tables, binomial probability estimated tail area taking maximum nuisance parameter. Algorithm simple step search. data may also matrix. case Y entered matrix(c(y1, n1 - y1, y2, n2 - y2), 2, 2, byrow = TRUE).","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRotsst.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"RR exact CI, OTSST method. — RRotsst","text":"Koopman PAR, 1984. Confidence intervals ratio two binomial proportions. Biometrics 40:513-517. Agresti , Min Y, 2001.  small-sample confidence intervals parameters discrete distribution. Biometrics 57: 963-971. Berger RL, Boos DD, 1994. P values maximized confidence set nuisance parameter. Journal American Statistical Association 89:214-220.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/RRotsst.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"RR exact CI, OTSST method. — RRotsst","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRotsst.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RR exact CI, OTSST method. — RRotsst","text":"","code":"# All examples represent the same observation, with data entry by multiple # options.  y_vector <- c(4, 24, 12, 28) RRotsst(y_vector, rnd = 3) #>  #> PF  #> 95% interval estimates #>  #>     PF     LL     UL  #> 0.6111 0.0148 0.8519  #>   # PF # 95% interval estimates  #    PF     LL     UL # 0.6111 0.0148 0.8519  y_matrix <- matrix(c(4, 20, 12, 16), 2, 2, byrow = TRUE) RRotsst(y_matrix, rnd = 3) #>  #> PF  #> 95% interval estimates #>  #>     PF     LL     UL  #> 0.6111 0.0148 0.8519  #>   # PF # 95% interval estimates  #    PF     LL     UL # 0.6111 0.0148 0.8519  require(dplyr) data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 2),   y = c(1, 3, 7, 5),   n = c(12, 12, 14, 14),   cage = rep(paste(\"cage\", 1:2), 2))  data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),     sum_n = sum(n)) RRotsst(data = data2, formula =  cbind(sum_y, sum_n) ~ group,    compare = c(\"treated\", \"control\")) #>  #> PF  #> 95% interval estimates #>  #>     PF     LL     UL  #> 0.6111 0.0148 0.8519  #>   # PF # 95% interval estimates # # PF     LL     UL # 0.6111 0.0148 0.8519"},{"path":"https://abs-dev.github.io/PF/reference/rrscclass.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rrsc — rrsc-class","title":"Data class rrsc — rrsc-class","text":"data class rrsc","code":""},{"path":"https://abs-dev.github.io/PF/reference/rrscclass.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rrsc — rrsc-class","text":"estimate:  vector point interval estimate rnd:  many digits round display alpha:  complement c.. estimator:  either \"PF\" \"RR\" Y: data.frame restructured input","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/rrscclass.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rrsc — rrsc-class","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/rrsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rrsi — rrsi-class","title":"Data class rrsi — rrsi-class","text":"data class rrsi","code":""},{"path":"https://abs-dev.github.io/PF/reference/rrsi.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rrsi — rrsi-class","text":"Y: data.frame restructured input k:  likelihood ratio criterion rnd:  digits round display alpha:  complement c.. estimate:  vector point interval estimate estimator:  either \"PF\" \"IDR\"","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/rrsi.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rrsi — rrsi-class","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/rrstrclass.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rrstr — rrstr-class","title":"Data class rrstr — rrstr-class","text":"data class rrstr","code":""},{"path":"https://abs-dev.github.io/PF/reference/rrstrclass.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rrstr — rrstr-class","text":"estimate:   vector point interval estimate rnd:   many digits round display alpha:   complement c.. estimator:   either \"PF\" \"RR\" hom: list homogeneity statistic, p-value, degrees freedom. Phi == 0 | Phi == 1, homogeneity test possible error message displays Y: data.frame restructured input compare:   groups compared","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/rrstrclass.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rrstr — rrstr-class","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRtosst.html","id":null,"dir":"Reference","previous_headings":"","what":"RR exact CI, TOSST method. — RRtosst","title":"RR exact CI, TOSST method. — RRtosst","text":"Estimates confidence interval risk ratio prevented fraction; exact method based score statistic (inverts two one-sided tests).","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRtosst.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RR exact CI, TOSST method. — RRtosst","text":"","code":"RRtosst(   y = NULL,   formula = NULL,   data = NULL,   compare = c(\"vac\", \"con\"),   alpha = 0.05,   pf = TRUE,   stepstart = 0.1,   iter.max = 36,   converge = 1e-06,   rnd = 3,   trace.it = FALSE,   nuisance.points = 120,   gamma = 1e-06 )"},{"path":"https://abs-dev.github.io/PF/reference/RRtosst.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RR exact CI, TOSST method. — RRtosst","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference group). formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment. data data.frame containing variables formula. compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. alpha Complement confidence level. pf Estimate RR complement PF? stepstart starting interval step search iter.max Maximum number iterations converge Convergence criterion rnd Number digits rounding. Affects display , estimates. trace.Verbose tracking iterations? nuisance.points number points evaluate nuisance parameter gamma parameter Berger-Boos correction (restricts range nuisance parameter evaluation)","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRtosst.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RR exact CI, TOSST method. — RRtosst","text":"rr1 object following fields. estimate: vector point interval estimate estimator: either \"PF\" \"RR\" y: data.frame \"y1\", \"n1\", \"y2\", \"n2\" values. rnd: many digits round display alpha: complement confidence level","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRtosst.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"RR exact CI, TOSST method. — RRtosst","text":"Estimates confidence intervals based score statistic 'exact' sense accounting discreteness. Inverts two one-sided score tests. score statistic used select tail area tables, binomial probability estimated tail area taking maximum nuisance parameter. Algorithm simple step search. data may also matrix. case Y entered matrix(c(y1, n1-y1, y2, n2-y2), 2, 2, byrow = TRUE).","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRtosst.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"RR exact CI, TOSST method. — RRtosst","text":"Koopman PAR, 1984. Confidence intervals ratio two binomial proportions. Biometrics 40:513-517. Agresti , Min Y, 2001.  small-sample confidence intervals parameters discrete distribution. Biometrics 57: 963-971. Berger RL, Boos DD, 1994. P values maximized confidence set nuisance parameter. Journal American Statistical Association 89:214-220.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/RRtosst.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"RR exact CI, TOSST method. — RRtosst","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/RRtosst.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RR exact CI, TOSST method. — RRtosst","text":"","code":"# Both examples represent the same observation, with data entry by vector # and matrix notation.  y_vector <- c(4, 24, 12, 28) RRtosst(y_vector) #>  #> PF  #> 95% interval estimates #>  #>    PF    LL    UL  #> 0.611 0.012 0.902  #>   # PF # 95% interval estimates  #    PF    LL    UL # 0.611 0.012 0.902  y_matrix <- matrix(c(4, 20, 12, 16), 2, 2, byrow = TRUE) #      [, 1] [, 2] # [1, ]    4   20 # [2, ]   12   16  RRtosst(y_matrix) #>  #> PF  #> 95% interval estimates #>  #>    PF    LL    UL  #> 0.611 0.012 0.902  #>   # PF # 95% interval estimates  #    PF    LL    UL # 0.611 0.012 0.902  require(dplyr) data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 2),   y = c(1, 3, 7, 5),   n = c(12, 12, 14, 14),   cage = rep(paste(\"cage\", 1:2), 2)) data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),     sum_n = sum(n)) RRtosst(data = data2, formula =  cbind(sum_y, sum_n) ~ group,   compare = c(\"treated\", \"control\")) #>  #> PF  #> 95% interval estimates #>  #>    PF    LL    UL  #> 0.611 0.012 0.902  #>   # PF # 95% interval estimates  #    PF    LL    UL # 0.611 0.012 0.902"},{"path":"https://abs-dev.github.io/PF/reference/rsb.html","id":null,"dir":"Reference","previous_headings":"","what":"Rao-Scott weights. — rsb","title":"Rao-Scott weights. — rsb","text":"Rao-Scott weights.","code":""},{"path":"https://abs-dev.github.io/PF/reference/rsb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rao-Scott weights. — rsb","text":"","code":"rsb(y = NULL, n = NULL, formula = NULL, data = NULL, id = NULL)"},{"path":"https://abs-dev.github.io/PF/reference/rsb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rao-Scott weights. — rsb","text":"y vector number positive. n vector total number. formula Formula form cbind(y, n) ~ id, y number positive, n total number, id factor estimating weights subset. data data.frame containing variables formula. id vector factor estimating weights subset.","code":""},{"path":"https://abs-dev.github.io/PF/reference/rsb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rao-Scott weights. — rsb","text":"list following elements. w: vector weights d: vector \\({d}_{}\\) estimates","code":""},{"path":"https://abs-dev.github.io/PF/reference/rsb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rao-Scott weights. — rsb","text":"Estimates cluster design effect \\({d}_{}\\) variance inflation due clustering method Rao Scott. rsb estimates \\({d}_{}\\) use rsbWt functions.","code":""},{"path":"https://abs-dev.github.io/PF/reference/rsb.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rao-Scott weights. — rsb","text":"Rao JNK, Scott AJ, 1992. simple method analysis clustered binary data. Biometrics 48:577-585.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/rsb.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Rao-Scott weights. — rsb","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/rsb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rao-Scott weights. — rsb","text":"","code":"# Weil's rat data (Table 1 of Rao and Scott) rsb(rat$y, rat$n, id = rat$group)$d #>  control  treated  #> 1.232495 3.952861  #  control  treated # 1.232495 3.952861 rsb(data = rat, formula = cbind(y, n) ~ group)$d #>  control  treated  #> 1.232495 3.952861  #  control  treated # 1.232495 3.952861"},{"path":"https://abs-dev.github.io/PF/reference/rsbWt.html","id":null,"dir":"Reference","previous_headings":"","what":"Rao-Scott weighting. — rsbWt","title":"Rao-Scott weighting. — rsbWt","text":"Rao-Scott weighting clustered binomial observations.","code":""},{"path":"https://abs-dev.github.io/PF/reference/rsbWt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rao-Scott weighting. — rsbWt","text":"","code":"rsbWt(fit = NULL, subset.factor = NULL, fit.only = TRUE)"},{"path":"https://abs-dev.github.io/PF/reference/rsbWt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rao-Scott weighting. — rsbWt","text":"fit stats::glm object. subset.factor Factor estimating phi subset.  converted factor factor. fit.Return new fit? FALSE, also returns weights phi estimates.","code":""},{"path":"https://abs-dev.github.io/PF/reference/rsbWt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rao-Scott weighting. — rsbWt","text":"list following elements. fit: new model fit, updated estimated weights weights: vector weights d: vector \\({d}_{}\\) estimates","code":""},{"path":"https://abs-dev.github.io/PF/reference/rsbWt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rao-Scott weighting. — rsbWt","text":"Estimates cluster design effect \\({d}_{}\\) variance inflation due clustering method Rao Scott. Observations weighted inverse \\({d}_{}\\).","code":""},{"path":"https://abs-dev.github.io/PF/reference/rsbWt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rao-Scott weighting. — rsbWt","text":"Rao JNK, Scott AJ, 1992. simple method analysis clustered binary data. Biometrics 48:577-585.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/rsbWt.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Rao-Scott weighting. — rsbWt","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/rsbWt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rao-Scott weighting. — rsbWt","text":"","code":"birdm.fit <- glm(cbind(y, n - y) ~ tx-1, binomial, birdm) RRor(rsbWt(birdm.fit)) #>  #> 95% t intervals on 4 df #>  #> PF  #>     PF     LL     UL  #>  0.479 -1.061  0.868  #>  #>       mu.hat    LL     UL #> txcon  0.768 0.968 0.2659 #> txvac  0.400 0.848 0.0737 # # 95% t intervals on 4 df # # PF #     PF     LL     UL #  0.479 -1.061  0.868 # #       mu.hat    LL     UL # txcon  0.768 0.968 0.2659 # txvac  0.400 0.848 0.0737 #"},{"path":"https://abs-dev.github.io/PF/reference/set1.html","id":null,"dir":"Reference","previous_headings":"","what":"set1 dataset — set1","title":"set1 dataset — set1","text":"set1 dataset","code":""},{"path":"https://abs-dev.github.io/PF/reference/set1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"set1 dataset — set1","text":"3 x 4 matrix data Set1","code":""},{"path":"https://abs-dev.github.io/PF/reference/set1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"set1 dataset — set1","text":"need references!","code":""},{"path":"https://abs-dev.github.io/PF/reference/table6.html","id":null,"dir":"Reference","previous_headings":"","what":"table6 dataset — table6","title":"table6 dataset — table6","text":"table6 dataset","code":""},{"path":"https://abs-dev.github.io/PF/reference/table6.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"table6 dataset — table6","text":"matrix data Table6","code":""},{"path":"https://abs-dev.github.io/PF/reference/tauWt.html","id":null,"dir":"Reference","previous_headings":"","what":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"MME estimates binomial dispersion parameter tau (intra-cluster correlation).","code":""},{"path":"https://abs-dev.github.io/PF/reference/tauWt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"","code":"tauWt(   fit,   subset.factor = NULL,   fit.only = TRUE,   iter.max = 12,   converge = 1e-06,   trace.it = FALSE )"},{"path":"https://abs-dev.github.io/PF/reference/tauWt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"fit glm object. subset.factor Factor estimating phi subset.  converted factor factor. fit.Return final fit?  FALSE, also returns weights tau estimates. iter.max Maximum number iterations. converge Convergence criterion: difference model degrees freedom Pearson's chi-square. Default 1e-6. trace.Display print statements indicating progress","code":""},{"path":"https://abs-dev.github.io/PF/reference/tauWt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"list following elements. fit: new model fit, updated estimated weights weights: vector weights phi: vector phi estimates","code":""},{"path":"https://abs-dev.github.io/PF/reference/tauWt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"Estimates binomial dispersion parameter \\(\\tau\\) method moments. Iteratively refits model Williams procedure, weighting observations \\(1 / \\phi_{ij}\\), \\(\\phi_{ij} = 1 + \\tau_j(n_{ij} - 1)\\), \\(j\\) indexes subsets, \\(\\) indexes observations.","code":""},{"path":"https://abs-dev.github.io/PF/reference/tauWt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"Williams DA, 1982. Extra-binomial variation logistic linear models. Applied Statistics 31:144-148. Wedderburn RWM, 1974. Quasi-likelihood functions, generalized linear models, Gauss-Newton method. Biometrika 61:439-447.","code":""},{"path":[]},{"path":"https://abs-dev.github.io/PF/reference/tauWt.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"PF-package","code":""},{"path":"https://abs-dev.github.io/PF/reference/tauWt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"","code":"birdm.fit <- glm(cbind(y, n - y) ~ tx - 1, binomial, birdm) RRor(tauWt(birdm.fit)) #>  #> 95% t intervals on 4 df #>  #> PF  #>     PF     LL     UL  #>  0.489 -0.578  0.835  #>  #>       mu.hat    LL    UL #> txcon  0.737 0.944 0.320 #> txvac  0.376 0.758 0.104  # 95% t intervals on 4 df # # PF #     PF     LL     UL #  0.489 -0.578  0.835 # #       mu.hat    LL    UL # txcon  0.737 0.944 0.320 # txvac  0.376 0.758 0.104 # # binomial family only # any link"},{"path":"https://abs-dev.github.io/PF/news/index.html","id":"version-969","dir":"Changelog","previous_headings":"","what":"Version 9.6.9","title":"Version 9.6.9","text":"Fix issue #5: recycling 1x1 matrix scaler Add online documentation","code":""},{"path":"https://abs-dev.github.io/PF/news/index.html","id":"version-968","dir":"Changelog","previous_headings":"","what":"Version 9.6.8","title":"Version 9.6.8","text":"Skipped somehow","code":""},{"path":"https://abs-dev.github.io/PF/news/index.html","id":"version-961-to-962","dir":"Changelog","previous_headings":"","what":"Version 9.6.1 to 9.6.2","title":"Version 9.6.1 to 9.6.2","text":"Update documentation","code":""},{"path":"https://abs-dev.github.io/PF/news/index.html","id":"version-960","dir":"Changelog","previous_headings":"","what":"Version 9.6.0","title":"Version 9.6.0","text":"Update code formatting issues.","code":""},{"path":"https://abs-dev.github.io/PF/news/index.html","id":"version-954","dir":"Changelog","previous_headings":"","what":"Version 9.5.4","title":"Version 9.5.4","text":"Changes made Marie","code":""}]
