<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Estimates confidence intervals for the risk ratio or prevented
fraction from clustered or stratified data, using a Mantel-Haenszel
estimator for sparse data."><title>Mantel-Haenszel method, CI for common RR over strata or clusters with
sparse data. — RRmh • PF</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mantel-Haenszel method, CI for common RR over strata or clusters with
sparse data. — RRmh"><meta property="og:description" content="Estimates confidence intervals for the risk ratio or prevented
fraction from clustered or stratified data, using a Mantel-Haenszel
estimator for sparse data."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PF</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">9.6.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/PFVignette.html">PF Vignette</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ABS-dev/PF/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Mantel-Haenszel method, CI for common RR over strata or clusters with
sparse data.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ABS-dev/PF/blob/HEAD/R/RRmh.r" class="external-link"><code>R/RRmh.r</code></a></small>
      <div class="d-none name"><code>RRmh.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates confidence intervals for the risk ratio or prevented
fraction from clustered or stratified data, using a Mantel-Haenszel
estimator for sparse data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RRmh</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vac"</span>, <span class="st">"con"</span><span class="op">)</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  pf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rnd <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>Formula of the form <code>cbind(y, n) ~ x + cluster(w)</code>, where
<code>y</code> is the number positive, <code>n</code> is the group size, <code>x</code> is a
factor with two levels of treatment, and <code>w</code> is a factor indicating
the clusters.</p></dd>


<dt>data</dt>
<dd><p><code>data.frame</code> containing variables for formula</p></dd>


<dt>compare</dt>
<dd><p>Text vector stating the factor levels: <code>compare[1]</code> is the
vaccinate group to which <code>compare[2]</code> (control or reference) is compared.</p></dd>


<dt>Y</dt>
<dd><p>Matrix of data, \(K \times 4\). Each row is a stratum or
cluster. The columns are \(y1, n1, y2, n2\), where the y's are the number
of positive in each group, and the n is the total in each group. Group 1
corresponds to vaccinates and group 2 are controls or reference. If data
entered by formula and dataframe, <code>Y</code> is generated automatically.</p></dd>


<dt>alpha</dt>
<dd><p>Complement of the confidence level.</p></dd>


<dt>pf</dt>
<dd><p>Estimate <em>RR</em> or its complement <em>PF</em>?</p></dd>


<dt>rnd</dt>
<dd><p>Number of digits for rounding. Affects display only, not
estimates.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code><a href="rr1-class.html">rr1</a></code>  with the following fields.</p>
<dl><dt>estimate</dt>
<dd><p>vector of point and interval estimates:  point estimate,
lower confidence limit, upper confidence limit</p></dd>


<dt>estimator</dt>
<dd><p>either <code>"PF"</code> or <code>"RR"</code></p></dd>


<dt>y</dt>
<dd><p>data.frame of restructured input</p></dd>


<dt>rnd</dt>
<dd><p>how many digits to round the display</p></dd>


<dt>alpha</dt>
<dd><p>complement of confidence level</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Based on the Mantel-Haenszel (1959) procedure for sparse data
developed by Greenland and Robins (1985). The confidence limits are based
on asymptotic normality of the log(risk ratio).  Agresti and Hartzel (2000)
favor this procedure for small, sparse data sets, but they warn that it is
less efficient than maximum likelihood for large data sets.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If either all y1's or all y2's are zero, a division by zero may occur,
and a NaN returned for some values. <br><br> Vignette <em>Examples for
Stratified Designs</em> forthcoming with more examples. <br> Call to this
function may be one of two formats: (1) specify <code>data</code> and
<code>formula</code> or (2) as a matrix <code>Y</code> <br><br><code>RRmh(formula,
  data, compare = c('b','a'), pf = TRUE, alpha = 0.05, rnd = 3)</code> <br><br><code>RRmh(Y, pf = TRUE, alpha = 0.05, rnd = 3)</code></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Mantel N, Haenszel W, 1959.  Statistical aspects of the analysis
of data from retrospective studies of disease. <em>Journal of the
National Cancer Institute</em> 22:  719-748. <br><br> Greenland S, Robins JM,
1985.  Estimation of a common effect parameter from sparse follow-up data.
<em>Biometrics</em>  41:  55-68.  Errata, 45:  1323-1324. <br><br> Agresti A,
Hartzel J, 2000.  Strategies for comparing treatments on a binary response
with multi-centre data.  <em>Statistics in Medicine</em>  19:  1115-1139. <br>
Lachin JM, 2000.  <em>Biostatistical Methods:  The Assessment of Relative
Risks</em> (Wiley, New York), Sec. 4.3.1.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="rr1-class.html">rr1</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><a href="PF-package.html">PF-package</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Table 1 from Gart (1985)</span></span></span>
<span class="r-in"><span><span class="co">##  as data frame</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># tx group "b" is control</span></span></span>
<span class="r-in"><span><span class="fu">RRmh</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">n</span><span class="op">)</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="fu">cluster</span><span class="op">(</span><span class="va">clus</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     <span class="va">Table6</span>,</span></span>
<span class="r-in"><span>     compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a'</span>, <span class="st">'b'</span><span class="op">)</span>, pf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RR </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% interval estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RR   LL   UL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.67 1.37 5.23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># RR</span></span></span>
<span class="r-in"><span><span class="co"># 95% interval estimates</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#   RR   LL   UL</span></span></span>
<span class="r-in"><span><span class="co"># 2.67 1.37 5.23</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## or as matrix</span></span></span>
<span class="r-in"><span><span class="fu">RRmh</span><span class="op">(</span>Y <span class="op">=</span> <span class="va">table6</span>, pf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RR </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% interval estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RR   LL   UL </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.67 1.37 5.23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># RR</span></span></span>
<span class="r-in"><span><span class="co"># 95% interval estimates</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#   RR   LL   UL</span></span></span>
<span class="r-in"><span><span class="co"># 2.67 1.37 5.23</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by CVB Statistics, David Siev, Marie Vendettuoli, Thomas Kent.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

