[{"path":"/articles/PFVignette.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"PF Vignette","text":"PF package collection functions related estimating prevented fraction, \\(PF=1-RR\\) , \\(RR={{{\\pi}_{2}}}/{{{\\pi}_{1}}}\\;\\) .","code":""},{"path":"/articles/PFVignette.html","id":"technical-notes","dir":"Articles","previous_headings":"Introduction","what":"Technical notes","title":"PF Vignette","text":"Optimization. Unless otherwise stated, optimization DUD algorithm (Ralston Jennrich 1978). Level tested. help files indicate level testing undergone function. cases subjective judgement, since functions originally tested SPlus ported R recently.","code":""},{"path":[]},{"path":"/articles/PFVignette.html","id":"the-score-statistic","dir":"Articles","previous_headings":"Score based methods","what":"The score statistic","title":"PF Vignette","text":"Confidence intervals risk ratio may based score statistic Miettinen Nurminen (1985), \\[\\frac{{{{\\hat{\\pi }}}_{2}}-{{\\rho }_{0}}{{{\\hat{\\pi }}}_{1}}}{\\sqrt{\\left( {{{{\\tilde{\\pi }}}_{2}}(1-{{{\\tilde{\\pi }}}_{2}})}/{{{n}_{2}}}\\; \\right)+\\rho _{0}^{2}\\left( {{{{\\tilde{\\pi }}}_{1}}(1-{{{\\tilde{\\pi }}}_{1}})}/{{{n}_{1}}}\\; \\right)}}\\] hat indicates MLE tilde indicates MLE restriction \\(\\rho ={{\\rho }_{0}}\\).","code":""},{"path":"/articles/PFVignette.html","id":"asymptotic-intervals","dir":"Articles","previous_headings":"Score based methods","what":"Asymptotic intervals","title":"PF Vignette","text":"RRsc() estimates asymptotic confidence intervals risk ratio prevented fraction based score statistic. Interval estimates returned three estimators. score method originally introduced (Koopman 1984). Gart Nam’s modification includes skewness correction (Gart Nam 1988). method (Miettinen Nurminen 1985) version made slightly conservative Koopman’s including factor \\({(N-1)}/{N}\\;\\). Starting estimates algorithm obtained modified Katz method (log method 0.5 added cell). forms Katz estimate may retrieved returned object using RRsc()\\$estimate.","code":"require(PF) ## Loading required package: PF RRsc(c(4,24,12,28)) ##  ## PF  ## 95% interval estimates ##  ##                 PF     LL    UL ## MN method    0.611 0.0251 0.857 ## score method 0.611 0.0328 0.855 ## skew corr    0.611 0.0380 0.876"},{"path":"/articles/PFVignette.html","id":"exact-intervals","dir":"Articles","previous_headings":"Score based methods","what":"Exact intervals","title":"PF Vignette","text":"methods give intervals `exact’ sense based actual sampling distribution rather approximation . score statistic used select \\(2 \\times 2\\) tables fall tail area, binomial probability estimated tail area taking maximum nuisance parameter. search tail area made efficient Berger-Boos correction (Berger Boos 1994). gives intervals obtained inverting two one-sided score tests; gives intervals obtained inverting one two-sided score test. thus conservative, preserving least \\({\\alpha }/{2}\\;\\) tail. (Agresti Min 2001) discuss properties relative benefits two approaches. price exactnesss conservatism, due discreteness binomial distribution (Agresti 2001). means actual coverage confidence interval exactly conform nominal coverage, less . (See also (Agresti 2003).) functions use simple step search algorithm.","code":"RRotsst(c(4,24,12,28)) ##  ## PF  ## 95% interval estimates ##  ##     PF     LL     UL  ## 0.6111 0.0148 0.8519 RRtosst(c(4,24,12,28)) ##  ## PF  ## 95% interval estimates ##  ##    PF    LL    UL  ## 0.611 0.012 0.902"},{"path":"/articles/PFVignette.html","id":"stratified-designs","dir":"Articles","previous_headings":"","what":"Stratified designs","title":"PF Vignette","text":"Methods estimating common stratified clustered designs depend homogeneity respect common parameter.","code":""},{"path":"/articles/PFVignette.html","id":"gart-nam-score-method","dir":"Articles","previous_headings":"Stratified designs","what":"Gart-Nam score method","title":"PF Vignette","text":"(Gart 1985) (Gart Nam 1988) derived score statistic common estimate designs multiple independent strata, showed identical one proposed (Radhakrishnan 1965) different perspective. provides confidence intervals homogeneity test based Gart’s statistic. Data may input two ways, either using formula data frame, matrix.","code":"RRstr(cbind(y,n) ~ tx + cluster(clus), Table6 , compare = c(\"a\", \"b\"), pf = F) ##  ## Test of homogeneity across clusters ##  ## stat  0.954  ## df    3  ## p     0.812  ##  ## RR  ## 95% interval estimates ##  ##             RR   LL   UL ## starting  2.66 1.37 5.18 ## mle       2.65 1.39 5.03 ## skew corr 2.65 1.31 5.08 # Data matrix input: # RRstr(Y = table6, pf = F)"},{"path":"/articles/PFVignette.html","id":"mantel-haenszel-estimator","dir":"Articles","previous_headings":"Stratified designs","what":"Mantel-Haenszel estimator","title":"PF Vignette","text":"widely-used heuristic method sparse frequency tables weighted average approach (Mantel Haenszel 1959). review Mantel-Haenzel approach point relationship method proposed (Cochran 1954), basis Rhadakrishnan’s method (Radhakrishnan 1965), alluded section~\\(\\ref{sec:gart}\\).} MH interval estimates based asymptotic normality log risk ratio. utilizes variance estimator given (Greenland Robins 1985) sparse strata. resulting asymptotic estimator consistent case sparse strata number strata assumed increasing, case limited number strata stratum size assumed increasing. latter case, however, less efficient maximum likelihood Greenland Robins (1985). Additional discussion may found Section 4.3.1 (Lachin 2000), (Landis et al. 2005), (Somes O’Brien 2006).","code":"RRmh(cbind(y,n) ~ tx + cluster(clus), Table6 , compare = c(\"a\", \"b\"), pf = F) ##  ## RR  ## 95% interval estimates ##  ##   RR   LL   UL  ## 2.67 1.37 5.23 # Data matrix input: # RRmh(Y = table6, pf = F)"},{"path":"/articles/PFVignette.html","id":"examples","dir":"Articles","previous_headings":"Stratified designs","what":"Examples","title":"PF Vignette","text":"fuller set examples, see vignette .","code":""},{"path":[]},{"path":"/articles/PFVignette.html","id":"logistic-regression-estimates","dir":"Articles","previous_headings":"Model based intervals","what":"Logistic regression estimates","title":"PF Vignette","text":"Intervals may estimated logistic regression models . takes fit object estimates intervals delta method.","code":"bird.fit <- glm(cbind(y,n-y) ~ tx - 1, binomial, bird) RRor(bird.fit) ## NULL ##  ## 95% t intervals on 4 df ##  ## PF  ##      PF      LL      UL  ##  0.5000 -0.0406  0.7598  ##  ##       mu.hat    LL    UL ## txcon  0.733 0.896 0.466 ## txvac  0.367 0.624 0.168"},{"path":"/articles/PFVignette.html","id":"estimating-the-dispersion-parameter","dir":"Articles","previous_headings":"Model based intervals","what":"Estimating the dispersion parameter","title":"PF Vignette","text":"binomial GLM weights \\[\\frac{\\hat{\\pi }(1-\\hat{\\pi })}{(\\hat{\\varphi })/n\\;}\\] \\((\\hat{\\varphi })\\) function dispersion parameter.","code":""},{"path":"/articles/PFVignette.html","id":"dispersion-parameter-varphi","dir":"Articles","previous_headings":"Model based intervals > Estimating the dispersion parameter","what":"Dispersion parameter \\(\\varphi\\)","title":"PF Vignette","text":"simple estimator dispersion parameter, \\(\\varphi\\), may estimated method moments [Wed74]. given . form dispersion parameter \\((\\varphi)=\\varphi\\), \\(\\varphi\\) estimated \\({X^2}/{df}\\;\\), Pearson statistic divided degrees freedom. Note \\(\\varphi\\) estimator may obtained family , fact, used reweight original fit: makes easy estimate intervals single command. also allows different estimates \\({\\hat{\\varphi}}\\) specified subsets data. want subtract degree freedom additional parameter, can entering degrees freedom argument .","code":"phiWt(bird.fit, fit.only = F)$phi ##      all  ## 2.471592 summary(update(bird.fit, family = quasibinomial))$disp ## [1] 2.471592 # model weighted by phi hat RRor(phiWt(bird.fit)) ## NULL ##  ## 95% t intervals on 4 df ##  ## PF  ##     PF     LL     UL  ##  0.500 -0.583  0.842  ##  ##       mu.hat    LL     UL ## txcon  0.733 0.943 0.3121 ## txvac  0.367 0.752 0.0997 # model with separate phi for vaccinates and controls RRor(phiWt(bird.fit, subset.factor = bird$tx)) ## NULL ##  ## 95% t intervals on 4 df ##  ## PF  ##     PF     LL     UL  ##  0.500 -0.645  0.848  ##  ##       mu.hat    LL     UL ## txcon  0.733 0.938 0.3330 ## txvac  0.367 0.767 0.0925 # subtract 2 degrees of freedom RRor(phiWt(bird.fit, subset.factor = bird$tx), degf = 2) ## NULL ##  ## 95% t intervals on 2 df ##  ## PF  ##     PF     LL     UL  ##  0.500 -2.164  0.921  ##  ##       mu.hat    LL     UL ## txcon  0.733 0.975 0.1635 ## txvac  0.367 0.895 0.0377"},{"path":"/articles/PFVignette.html","id":"dispersion-parameter-tau","dir":"Articles","previous_headings":"Model based intervals > Estimating the dispersion parameter","what":"Dispersion parameter \\(\\tau\\)","title":"PF Vignette","text":"overdispersion due intra-cluster correlation, may make sense estimate dispersion function intra-cluster correlation parameter \\(\\tau\\). words, \\({({\\varphi }_{ij})}=1+{{\\tau }_{j}}({{n}_{ij}}-1)\\). using Williams procedure (Williams 1982). example estimates estimates. cluster sizes . Let’s see happens modify data set. data set cluster fractions differing cluster sizes. Note increasing cluster size can make things worse intra-cluster correlation. Now let’s compare weights unequal cluster sizes. output , represents \\(1/(\\hat{\\varphi })\\;\\) \\(n/(\\hat{\\varphi })\\;\\) Look last two rows. Note directly proportional within treatment group, . intra-cluster correlation, increasing cluster size give corresponding increase information.","code":"# model weighted using tau hat RRor(tauWt(bird.fit, subset.factor = bird$tx)) ## NULL ##  ## 95% t intervals on 4 df ##  ## PF  ##     PF     LL     UL  ##  0.500 -0.645  0.848  ##  ##       mu.hat    LL     UL ## txcon  0.733 0.938 0.3330 ## txvac  0.367 0.767 0.0925 # different cluster sizes, same cluster fractions birdm.fit <- glm(cbind(y,n-y) ~ tx - 1, binomial, birdm) RRor(tauWt(birdm.fit, subset.factor = birdm$tx)) ## NULL ##  ## 95% t intervals on 4 df ##  ## PF  ##     PF     LL     UL  ##  0.490 -0.605  0.838  ##  ##       mu.hat    LL    UL ## txcon  0.737 0.942 0.328 ## txvac  0.376 0.764 0.101 # Compare phi and tau weights #   phi.wts <-phiWt(birdm.fit,fit.only = F, subset.factor = birdm$tx)$weights tau.wts <- tauWt(birdm.fit,fit.only = F, subset.factor = birdm$tx)$weights w <- cbind(w.phi=phi.wts,w.tau=tau.wts,nw.phi=phi.wts*birdm$n,         nw.tau=tau.wts*birdm$n) print(cbind(birdm[,c(3,1,2)],round(w, 2)), row.names=F) ##   tx  y  n w.phi w.tau nw.phi nw.tau ##  vac  1 10  0.32  0.35   3.20   3.55 ##  vac  8 20  0.32  0.21   6.40   4.13 ##  vac  9 15  0.32  0.26   4.80   3.92 ##  con  8 16  0.21  0.27   3.39   4.33 ##  con  8 10  0.21  0.38   2.12   3.82 ##  con 27 30  0.21  0.16   6.36   4.84"},{"path":"/articles/PFVignette.html","id":"rao-scott-weights","dir":"Articles","previous_headings":"Model based intervals","what":"Rao-Scott weights","title":"PF Vignette","text":"(Rao Scott 1992) give method weighting clustered binomial observations based variance inflation due clustering. relate approach concepts design effect effective sample size familiar survey sampling, illustrate use variety contexts. implements manner . general use, function just returns design effect estimates weights.","code":"# model weighted with Rao-Scott weights RRor(rsbWt(birdm.fit, subset.factor = birdm$tx)) ## NULL ##  ## 95% t intervals on 4 df ##  ## PF  ##     PF     LL     UL  ##  0.479 -0.314  0.793  ##  ##       mu.hat    LL    UL ## txcon  0.768 0.960 0.311 ## txvac  0.400 0.717 0.149 # just the design effect estimates rsb(birdm$y, birdm$n)$d ##      all  ## 6.334514"},{"path":"/articles/PFVignette.html","id":"likelihood-based-intervals","dir":"Articles","previous_headings":"","what":"Likelihood based intervals","title":"PF Vignette","text":"function estimates likelihood support intervals profile likelihood Section 7.6 (Royall 1997). Likelihood support intervals usually formed based desired likelihood ratio, \\({1}/{k}\\;\\), often \\({1}/{8}\\;\\) \\({1}/{32}\\;\\). conditions log likelihood ratio may follow chi-square distribution. , \\(\\alpha =1-{{F}_{{{\\chi }^{2}}}}\\left( 2\\log (k),1 \\right)\\). make conversion \\(\\alpha\\) argument .","code":"RRlsi(c(4,24,12,28)) ##  ## 1/8 likelihood support interval for PF  ##  ## corresponds to 95.858% confidence ##   (under certain assumptions) ##  ## PF  ##     PF     LL     UL  ## 0.6111 0.0168 0.8859 RRlsi(c(4,24,12,28), use.alpha = T) ##  ## 1/6.826 likelihood support interval for PF  ##  ## corresponds to 95% confidence ##   (under certain assumptions) ##  ## PF  ##     PF     LL     UL  ## 0.6111 0.0495 0.8792"},{"path":"/articles/PFVignette.html","id":"incidence-ratio","dir":"Articles","previous_headings":"","what":"Incidence ratio","title":"PF Vignette","text":"incidence number cases per subject-time. distribution assumed Poisson. certain designs, incidence ratio () used measure treatment effect. Correspondingly, \\({{PF}_{IR}}=1-IR\\) used measure effect intervention preventive, vaccination. also called incidence density ratio (), term used following functions.","code":""},{"path":"/articles/PFVignette.html","id":"score-method","dir":"Articles","previous_headings":"Incidence ratio","what":"Score method","title":"PF Vignette","text":"estimates confidence interval incidence density ratio using Siev’s formula Appendix 1 (Siev 1994) based Poisson score statistic. \\[IDR=\\widehat{IDR}\\left\\{ 1+\\left( \\frac{1}{{{y}_{1}}}+\\frac{1}{{{y}_{2}}} \\right)\\frac{z_{\\alpha /2}^{2}}{2}\\ \\ \\pm \\ \\ \\frac{z_{\\alpha /2}^{2}}{2{{y}_{1}}{{y}_{2}}}\\sqrt{{{y}_{\\bullet }}\\left( {{y}_{\\bullet }}z_{\\alpha /2}^{2}+4{{y}_{1}}{{y}_{2}} \\right)} \\right\\}\\]","code":"IDRsc(c(26,204,10,205), pf = F) ##  ## IDR  ## 95% interval estimates ##  ##  IDR   LL   UL  ## 2.61 1.28 5.34"},{"path":"/articles/PFVignette.html","id":"likelihood-method","dir":"Articles","previous_headings":"Incidence ratio","what":"Likelihood method","title":"PF Vignette","text":"likelihood support interval may estimated based orthogonal factoring reparameterized likelihood. Section 7.2 (Royall 1997) implements method. Likelihood support intervals usually formed based desired likelihood ratio, \\({1}/{k}\\;\\), often \\({1}/{8}\\;\\) \\({1}/{32}\\;\\). conditions log likelihood ratio may follow chi square distribution. , \\(\\alpha =1-{{F}_{{{\\chi }^{2}}}}\\left( 2\\log (k),1 \\right)\\). make conversion \\(\\alpha\\) tp argument .","code":"IDRlsi(c(26,204,10,205), pf = F) ##  ## 1/8 likelihood support interval for IDR  ##  ## corresponds to 95.858% confidence ##   (under certain assumptions) ##  ## IDR  ##  IDR   LL   UL  ## 2.61 1.26 5.88 IDRlsi(c(26,204,10,205), pf = F, use.alpha = T) ##  ## 1/6.826 likelihood support interval for IDR  ##  ## corresponds to 95% confidence ##   (under certain assumptions) ##  ## IDR  ##  IDR   LL   UL  ## 2.61 1.30 5.69"},{"path":[]},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"CVB Statistics. Maintainer, former owner. David Siev. Author.            2019 Marie Vendettuoli. Author.            2019 Thomas Kent. Author.            starting 2020","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Siev D, Vendettuoli M, Kent T (2024). PF: Prevented fraction. R package version 9.6.7, https://github.com/ABS-dev/PF/blob/master/doc/PFPackageManual.pdf, https://www.aphis.usda.gov/animal_health/vet_biologics/publications/STATWI0007.pdf.","code":"@Manual{,   title = {PF: Prevented fraction},   author = {David Siev and Marie Vendettuoli and Thomas Kent},   year = {2024},   note = {R package version 9.6.7, https://github.com/ABS-dev/PF/blob/master/doc/PFPackageManual.pdf},   url = {https://www.aphis.usda.gov/animal_health/vet_biologics/publications/STATWI0007.pdf}, }"},{"path":[]},{"path":"/index.html","id":"to-install-or-update-pf","dir":"","previous_headings":"","what":"To install or update PF:","title":"Prevented fraction","text":"within R Installing last release v9.5.4 See historical releases Installing work--progress towards v9.5.5","code":"require(devtools) install_github(\"ABS-dev/PF\", ref = \"v9.5.4\") require(devtools) install_github(\"ABS-dev/PF\")"},{"path":"/index.html","id":"package-vignette","dir":"","previous_headings":"","what":"Package Vignette:","title":"Prevented fraction","text":"Read online https://www.aphis.usda.gov/animal_health/vet_biologics/publications/STATWI0007.pdf","code":""},{"path":"/index.html","id":"package-manual","dir":"","previous_headings":"","what":"Package Manual:","title":"Prevented fraction","text":"Read online https://github.com/ABS-dev/PF/blob/master/inst/doc/PFPackageManual.pdf","code":""},{"path":"/reference/bird.html","id":null,"dir":"Reference","previous_headings":"","what":"bird dataset — bird","title":"bird dataset — bird","text":"bird dataset","code":""},{"path":"/reference/bird.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"bird dataset — bird","text":"data.frame 6 observations following 4 variables, NAs y number positive n total number group tx x tx treatment 'vac' 'con' ?","code":""},{"path":"/reference/bird.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"bird dataset — bird","text":"need references","code":""},{"path":"/reference/birdm.html","id":null,"dir":"Reference","previous_headings":"","what":"birdm dataset — birdm","title":"birdm dataset — birdm","text":"birdm dataset","code":""},{"path":"/reference/birdm.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"birdm dataset — birdm","text":"data.frame 6 observations following 4 variables, NAs y number positive n total number group tx x tx treatment 'vac' 'con' ?","code":""},{"path":"/reference/birdm.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"birdm dataset — birdm","text":"need references","code":""},{"path":"/reference/dfSet1.html","id":null,"dir":"Reference","previous_headings":"","what":"Set1 dataset — Set1","title":"Set1 dataset — Set1","text":"Set1 dataset","code":""},{"path":"/reference/dfSet1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Set1 dataset — Set1","text":"data.frame 6 observation following 4 variables, NAs y number positive n total number group tx x clus tx treatment 'vac' 'con' clus cluster ID","code":""},{"path":"/reference/dfSet1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Set1 dataset — Set1","text":"need references","code":""},{"path":"/reference/dfTable6.html","id":null,"dir":"Reference","previous_headings":"","what":"Table6 dataset — Table6","title":"Table6 dataset — Table6","text":"Table6 dataset","code":""},{"path":"/reference/dfTable6.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Table6 dataset — Table6","text":"data.frame 8 observations following 4 variables, NAs y number positive n total number group tx x clus tx treatment '' 'b' clus cluster ID","code":""},{"path":"/reference/dfTable6.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Table6 dataset — Table6","text":"Table 1 Gart (1985)","code":""},{"path":"/reference/dot-rr.score.asymp.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal function. — .rr.score.asymp","title":"Internal function. — .rr.score.asymp","text":"Internal function.","code":""},{"path":"/reference/dot-rr.score.asymp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal function. — .rr.score.asymp","text":"","code":".rr.score.asymp(y, alpha = 0.05, iter.max = 18, converge = 1e-04, mn = FALSE)"},{"path":"/reference/dot-rr.score.asymp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal function. — .rr.score.asymp","text":"y data alpha alpha iter.max maximum number iterations converge convergence criterion mn boolean whether calculate MN use default value 1.0","code":""},{"path":"/reference/dot-rr.score.asymp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Internal function. — .rr.score.asymp","text":"","code":"# none"},{"path":"/reference/IDRlsi.html","id":null,"dir":"Reference","previous_headings":"","what":"IDR likelihood support interval. — IDRlsi","title":"IDR likelihood support interval. — IDRlsi","text":"Estimates likelihood support interval incidence density ratio prevented fraction based .","code":""},{"path":"/reference/IDRlsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IDR likelihood support interval. — IDRlsi","text":"","code":"IDRlsi(   y = NULL,   formula = NULL,   data = NULL,   alpha = 0.05,   k = 8,   use.alpha = FALSE,   pf = TRUE,   converge = 1e-08,   rnd = 3,   start = NULL,   trace.it = FALSE,   iter.max = 24,   compare = c(\"con\", \"vac\") )"},{"path":"/reference/IDRlsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"IDR likelihood support interval. — IDRlsi","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference). formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment.#' data data.frame containing variables formula. alpha Complement confidence level. k Likelihood ratio criterion. use.alpha Base choice k relationship alpha? pf Estimate IDR complement PF? converge Convergence criterion rnd Number digits rounding. Affects display , estimates. start describe . trace.Verbose tracking iterations? iter.max Maximum number iterations compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared.","code":""},{"path":"/reference/IDRlsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"IDR likelihood support interval. — IDRlsi","text":"rrsi object following elements. estimate vector point interval estimate estimator either PF IDR y data.frame \"y1\", \"n1\", \"y2\", \"n2\" values. k Likelihood ratio criterion rnd many digits round display alpha complement confidence level","code":""},{"path":"/reference/IDRlsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"IDR likelihood support interval. — IDRlsi","text":"Estimates likelihood support interval incidence density ratio based orthogonal factoring reparameterized likelihood. incidence density number cases per subject-time; distribution assumed Poisson.  Likelihood support intervals usually formed based desired likelihood ratio, often 1/8 1/32. conditions log likelihood ratio may follow chi square distribution. , \\(\\alpha=1-F(2log(k), 1)\\), \\(F\\) chi-square CDF. RRsc() make conversion \\(\\alpha\\) k use.alpha = TRUE.  data may also matrix. case y entered matrix(c(y1, n1 - y1, y2, n2 - y2), 2, 2, byrow = TRUE).","code":""},{"path":"/reference/IDRlsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"IDR likelihood support interval. — IDRlsi","text":"Royall R. Statistical Evidence: Likelihood Paradigm. Chapman & Hall, Boca Raton, 1997. Section 7.2.","code":""},{"path":[]},{"path":"/reference/IDRlsi.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"IDR likelihood support interval. — IDRlsi","text":"PF-package","code":""},{"path":"/reference/IDRlsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"IDR likelihood support interval. — IDRlsi","text":"","code":"# Both examples represent the same observation, with data entry by vector # and matrix notation.  y_vector <- c(26, 204, 10, 205) IDRlsi(y_vector, pf = FALSE) #>  #> 1/8 likelihood support interval for IDR  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> IDR  #>  IDR   LL   UL  #> 2.61 1.26 5.88  #>   # 1/8 likelihood support interval for IDR  # corresponds to 95.858% confidence #   (under certain assumptions)  # IDR #  IDR   LL   UL # 2.61 1.26 5.88  y_matrix <- matrix(c(26, 178, 10, 195), 2, 2, byrow = TRUE) y_matrix #>      [,1] [,2] #> [1,]   26  178 #> [2,]   10  195 #      [, 1] [, 2] # [1, ]   26  178 # [2, ]   10  195  IDRlsi(y_matrix, pf = FALSE) #>  #> 1/8 likelihood support interval for IDR  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> IDR  #>  IDR   LL   UL  #> 2.61 1.26 5.88  #>   # 1/8 likelihood support interval for IDR  # corresponds to 95.858% confidence #   (under certain assumptions)  # IDR #  IDR   LL   UL # 2.61 1.26 5.88  data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 5),              n = c(rep(41, 4), 40, rep(41, 5)),              y = c(4, 5, 7, 6, 4, 1, 3, 3, 2, 1),              cage = rep(paste('cage', 1:5), 2)) IDRlsi(data = data1, formula = cbind(y, n) ~ group,                compare = c(\"treated\", \"control\"), pf = FALSE) #> 'y' and 'n' values will be summed by treated and control designation in datacolumn group #>  #> 1/8 likelihood support interval for IDR  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> IDR  #>  IDR   LL   UL  #> 2.61 1.26 5.88  #>   # 1/8 likelihood support interval for IDR  # corresponds to 95.858% confidence #   (under certain assumptions)  # IDR #  IDR   LL   UL # 2.61 1.26 5.88  require(dplyr) #> Loading required package: dplyr #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),     sum_n = sum(n))  IDRlsi(data = data2, formula = cbind(sum_y, sum_n) ~ group,                compare = c(\"treated\", \"control\"), pf = FALSE) #>  #> 1/8 likelihood support interval for IDR  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> IDR  #>  IDR   LL   UL  #> 2.61 1.26 5.88  #>   # 1/8 likelihood support interval for IDR  # corresponds to 95.858% confidence #   (under certain assumptions)  # IDR #  IDR   LL   UL # 2.61 1.26 5.88"},{"path":"/reference/IDRsc.html","id":null,"dir":"Reference","previous_headings":"","what":"IDR confidence interval. — IDRsc","title":"IDR confidence interval. — IDRsc","text":"Estimates confidence interval incidence density ratio prevented fraction based .","code":""},{"path":"/reference/IDRsc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IDR confidence interval. — IDRsc","text":"","code":"IDRsc(   y = NULL,   data = NULL,   formula = NULL,   compare = c(\"con\", \"vac\"),   alpha = 0.05,   pf = TRUE,   rnd = 3 )"},{"path":"/reference/IDRsc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"IDR confidence interval. — IDRsc","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference). data data.frame containing variables formula. formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment. compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. alpha Complement confidence level. pf Estimate IDR, complement PF? rnd Number digits rounding. Affects display , estimates.","code":""},{"path":"/reference/IDRsc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"IDR confidence interval. — IDRsc","text":"rr1 object following elements. estimate vector point interval estimate estimator either PF IDR y data vector rnd many digits round display alpha complement confidence level","code":""},{"path":"/reference/IDRsc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"IDR confidence interval. — IDRsc","text":"incidence density number cases per subject-time; distribution assumed Poisson. IDRsc estimates confidence interval incidence density ratio using Siev's formula based Poisson score statistic. \\( IDR=\\widehat{IDR}\\left\\{ 1+\\left(   \\frac{1}{{{y}_{1}}}+\\frac{1}{{{y}_{2}}} \\right)\\frac{z_{\\alpha /2}^{2}}{2}\\   \\ \\pm \\ \\ \\frac{z_{\\alpha /2}^{2}}{2{{y}_{1}}{{y}_{2}}}\\sqrt{{{y}_{\\bullet   }}\\left( {{y}_{\\bullet }}z_{\\alpha /2}^{2}+4{{y}_{1}}{{y}_{2}} \\right)}   \\right\\} \\)  data may also matrix. case y entered matrix(c(y1, n1 - y1, y2, n2 - y2), 2, 2, byrow = TRUE).","code":""},{"path":"/reference/IDRsc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"IDR confidence interval. — IDRsc","text":"Siev D, 1994. Estimating vaccine efficacy prospective studies. Preventive Veterinary Medicine 20:279-296, Appendix 1.  Graham PL, Mengersen K, Morton AP, 2003. Confidence limits ratio two rates based likelihood scores:non-iterative method Statistics Medicine 22:2071-2083.  Siev D, 2004. Letter editor. Statistics Medicine 23:693. (Typographical error formula: replace two final minus signs subscript dots.)","code":""},{"path":[]},{"path":"/reference/IDRsc.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"IDR confidence interval. — IDRsc","text":"PF-package","code":""},{"path":"/reference/IDRsc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"IDR confidence interval. — IDRsc","text":"","code":"# All examples represent the same observation, with data entry by vector, # matrix, and formula+data notation.  y_vector <- c(26, 204, 10, 205) IDRsc(y_vector, pf = FALSE) #>  #> IDR  #> 95% interval estimates #>  #>  IDR   LL   UL  #> 2.61 1.28 5.34  #>   # IDR # 95% interval estimates  #  IDR   LL   UL # 2.61 1.28 5.34  y_matrix <- matrix(c(26, 178, 10, 195), 2, 2, byrow = TRUE) y_matrix #>      [,1] [,2] #> [1,]   26  178 #> [2,]   10  195 #      [, 1] [, 2] # [1, ]   26  178 # [2, ]   10  195  IDRsc(y_matrix, pf = FALSE) #>  #> IDR  #> 95% interval estimates #>  #>  IDR   LL   UL  #> 2.61 1.28 5.34  #>   # IDR # 95% interval estimates  #  IDR   LL   UL # 2.61 1.28 5.34  require(dplyr) data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 5),             n = c(rep(41, 4), 40, rep(41, 5)),             y = c(4, 5, 7, 6, 4, 1, 3, 3, 2, 1),             cage = rep(paste('cage', 1:5), 2)) data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),   sum_n = sum(n)) IDRsc(data = data2, formula =  cbind(sum_y, sum_n) ~ group,     compare = c(\"treated\", \"control\"), pf = FALSE) #>  #> IDR  #> 95% interval estimates #>  #>  IDR   LL   UL  #> 2.61 1.28 5.34  #>   # IDR # 95% interval estimates  #  IDR   LL   UL # 2.61 1.28 5.34"},{"path":"/reference/New.html","id":null,"dir":"Reference","previous_headings":"","what":"New dataset — New","title":"New dataset — New","text":"New dataset","code":""},{"path":"/reference/New.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"New dataset — New","text":"data frame 52 observations following 3 variables, NAs cage cage ID. 1 - 26 tx treatment. one 'con' 'vac' pos numeric indicator positive response. 0 = FALSE 1 = TRUE","code":""},{"path":"/reference/New.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"New dataset — New","text":"need references","code":""},{"path":"/reference/PF-package.html","id":null,"dir":"Reference","previous_headings":"","what":"PF: Prevented fraction — PF-package","title":"PF: Prevented fraction — PF-package","text":"Functions related PF (prevented fraction). Calculate incidence density ratio, confidence interval, Rao-Scott weights PF multiple methods. See http://goo.gl/eJ6Rxi definition PF. endorsement, claim, warranty implied package. made available investigational pedagogical use .","code":""},{"path":[]},{"path":"/reference/PF-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"PF: Prevented fraction — PF-package","text":"Maintainer: CVB Statistics CVB.Data.Help@usda.gov [former owner] Authors: David Siev (2019) Marie Vendettuoli (2019) Thomas Kent (starting 2020)","code":""},{"path":"/reference/pf.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class pf — pf-class","title":"Data class pf — pf-class","text":"data class pf","code":""},{"path":"/reference/pf.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class pf — pf-class","text":"[estimator]  either \"PF\" \"IDR\" [rnd]  many digits round display [alpha]  complement c..","code":""},{"path":[]},{"path":"/reference/pf.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class pf — pf-class","text":"PF-package","code":""},{"path":"/reference/phiWt.html","id":null,"dir":"Reference","previous_headings":"","what":"Binomial dispersion parameter. — phiWt","title":"Binomial dispersion parameter. — phiWt","text":"MME estimate dispersion parameter phi.","code":""},{"path":"/reference/phiWt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Binomial dispersion parameter. — phiWt","text":"","code":"phiWt(fit, subset.factor = NULL, fit.only = TRUE, show.warns = FALSE)"},{"path":"/reference/phiWt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Binomial dispersion parameter. — phiWt","text":"fit glm object. subset.factor Factor estimating phi subset. fit.Return new fit?  FALSE, also returns weights phi estimates. show.warns Show warnings","code":""},{"path":"/reference/phiWt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Binomial dispersion parameter. — phiWt","text":"list following elements. fit new model fit, updated estimated weights weights vector weights phi vector phi estimates","code":""},{"path":"/reference/phiWt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Binomial dispersion parameter. — phiWt","text":"Estimates binomial dispersion parameter \\(\\phi\\) method moments. Refits model, weighting observations \\(1/\\phi\\). Uses quasibinomial family glm().","code":""},{"path":"/reference/phiWt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Binomial dispersion parameter. — phiWt","text":"Wedderburn RWM, 1974. Quasi-likelihood functions, generalized linear models, Gauss-Newton method. Biometrika 61:439-447.","code":""},{"path":[]},{"path":"/reference/phiWt.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Binomial dispersion parameter. — phiWt","text":"PF-package","code":""},{"path":"/reference/phiWt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Binomial dispersion parameter. — phiWt","text":"","code":"birdm.fit <- glm(cbind(y, n - y)~tx-1, binomial, birdm) RRor(phiWt(birdm.fit)) #> NULL #>  #> 95% t intervals on 4 df #>  #> PF  #>     PF     LL     UL  #>  0.479 -0.537  0.823  #>  #>       mu.hat   LL    UL #> txcon  0.768 0.95 0.367 #> txvac  0.400 0.78 0.111 # # 95% t intervals on 4 df # # PF #     PF     LL     UL #  0.479 -0.537  0.823 # #       mu.hat   LL    UL # txcon  0.768 0.95 0.367 # txvac  0.400 0.78 0.111 #"},{"path":"/reference/print.PF.html","id":null,"dir":"Reference","previous_headings":"","what":"Print values for PF data obhects. — print.rr1","title":"Print values for PF data obhects. — print.rr1","text":"Print values PF data obhects.","code":""},{"path":"/reference/print.PF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print values for PF data obhects. — print.rr1","text":"","code":"# S3 method for rr1 print(x, ...)  # S3 method for rror print(x, ...)  # S3 method for rrsi print(x, ...)  # S3 method for rrmp print(x, ...)  # S3 method for rrsc print(x, ...)  # S3 method for rrstr print(x, ...)"},{"path":"/reference/print.PF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print values for PF data obhects. — print.rr1","text":"x object class rr1, rror, rrsi, rrmp, rrstr, rrsc ... arguments used method","code":""},{"path":"/reference/rat.html","id":null,"dir":"Reference","previous_headings":"","what":"rat dataset — rat","title":"rat dataset — rat","text":"rat dataset","code":""},{"path":"/reference/rat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"rat dataset — rat","text":"data.frame 32 observations following 3 variables, NAs y number positive n total number group treatment group: 'control' 'treated'","code":""},{"path":"/reference/rat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"rat dataset — rat","text":"Weil's rat data (Table 1 Rao Scott)","code":""},{"path":"/reference/rr1-class.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rr1 — rr1-class","title":"Data class rr1 — rr1-class","text":"Data class rr1","code":""},{"path":"/reference/rr1-class.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rr1 — rr1-class","text":"[estimate]  vector point interval estimate [estimator]  either \"PF\" \"IDR\" [y]data.frame restructured input [rnd]many digits round display [alpha]complement c..","code":""},{"path":[]},{"path":"/reference/rr1-class.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rr1 — rr1-class","text":"PF-package","code":""},{"path":"/reference/RRlsi.html","id":null,"dir":"Reference","previous_headings":"","what":"RR likelihood support interval. — RRlsi","title":"RR likelihood support interval. — RRlsi","text":"likelihood support interval risk ratio prevented fraction likelihood profile.","code":""},{"path":"/reference/RRlsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RR likelihood support interval. — RRlsi","text":"","code":"RRlsi(   y = NULL,   formula = NULL,   data = NULL,   compare = c(\"vac\", \"con\"),   alpha = 0.05,   k = 8,   use.alpha = FALSE,   pf = TRUE,   iter.max = 50,   converge = 1e-06,   rnd = 3,   start = NULL,   track = FALSE,   full.track = FALSE )"},{"path":"/reference/RRlsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RR likelihood support interval. — RRlsi","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference group). formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment. data data.frame containing variables formula. compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. alpha Complement confidence level (see details). k Likelihood ratio criterion. use.alpha Base choice k relationship alpha? pf Estimate RR complement PF? iter.max Maximum number iterations converge Convergence criterion rnd Number digits rounding. Affects display onlyRR, estimates. start Optional starting value. track Verbose tracking iterations? full.track Verbose tracking iterations?","code":""},{"path":"/reference/RRlsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RR likelihood support interval. — RRlsi","text":"object class rrsi following fields: estimate matrix point interval estimates - see details estimator either \"PF\" \"RR\" y data.frame \"y1\", \"n1\", \"y2\", \"n2\" values. rnd many digits round display k likelihood ratio criterion alpha complement confidence level","code":""},{"path":"/reference/RRlsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"RR likelihood support interval. — RRlsi","text":"Estimates likelihood support interval RR PF profile likelihood method using DUD algorithm.  Likelihood support intervals usually formed based desired likelihood ratio, often 1/8 1/32. conditions log likelihood ratio may follow chi square distribution. , \\(\\alpha=1-F(2log(k), 1)\\), \\(F\\) chi-square CDF. RRlsi() make conversion \\(\\alpha\\) k use.alpha = TRUE.  data may also matrix. case y entered matrix(c(y1, n1-y1, y2, n2-y2), 2, 2, byrow = TRUE).","code":""},{"path":"/reference/RRlsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"RR likelihood support interval. — RRlsi","text":"Royall R. Statistical Evidence: Likelihood Paradigm. Chapman & Hall, Boca Raton, 1997.  Section 7.6  Ralston ML, Jennrich RI, 1978. DUD, Derivative-Free Algorithm Nonlinear Least Squares. Technometrics 20:7-14.","code":""},{"path":"/reference/RRlsi.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"RR likelihood support interval. — RRlsi","text":"PF-package","code":""},{"path":"/reference/RRlsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RR likelihood support interval. — RRlsi","text":"","code":"# All examples represent the same observation, with data entry by vector, # matrix, and formula+data notation.  y_vector <- c(4, 24, 12, 28) RRlsi(y_vector) #>  #> 1/8 likelihood support interval for PF  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> PF  #>     PF     LL     UL  #> 0.6111 0.0168 0.8859  #>   # 1/8 likelihood support interval for PF  # corresponds to 95.858% confidence #   (under certain assumptions)  # PF #     PF     LL     UL # 0.6111 0.0168 0.8859  y_matrix <- matrix(c(4, 20, 12, 16), 2, 2, byrow = TRUE) y_matrix #>      [,1] [,2] #> [1,]    4   20 #> [2,]   12   16 #      [, 1] [, 2] # [1, ]    4   20 # [2, ]   12   16  RRlsi(y_matrix) #>  #> 1/8 likelihood support interval for PF  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> PF  #>     PF     LL     UL  #> 0.6111 0.0168 0.8859  #>   # 1/8 likelihood support interval for PF  # corresponds to 95.858% confidence #   (under certain assumptions)  # PF #     PF     LL     UL # 0.6111 0.0168 0.8859  require(dplyr) data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 2),   y = c(1, 3, 7, 5),   n = c(12, 12, 14, 14),   cage = rep(paste('cage', 1:2), 2))  data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),     sum_n = sum(n)) RRlsi(data = data2, formula =  cbind(sum_y, sum_n) ~ group,    compare = c(\"treated\", \"control\")) #>  #> 1/8 likelihood support interval for PF  #>  #> corresponds to 95.858% confidence #>   (under certain assumptions) #>  #> PF  #>     PF     LL     UL  #> 0.6111 0.0168 0.8859  #>   # 1/8 likelihood support interval for PF # # corresponds to 95.858% confidence # (under certain assumptions) # # PF # PF     LL     UL # 0.6111 0.0168 0.8859"},{"path":"/reference/RRmh.html","id":null,"dir":"Reference","previous_headings":"","what":"Mantel-Haenszel method, CI for common RR over strata or clusters with\r\nsparse data. — RRmh","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with\r\nsparse data. — RRmh","text":"Estimates confidence intervals risk ratio prevented fraction clustered stratified data, using Mantel-Haenszel estimator sparse data.","code":""},{"path":"/reference/RRmh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with\r\nsparse data. — RRmh","text":"","code":"RRmh(   formula = NULL,   data = NULL,   compare = c(\"vac\", \"con\"),   Y,   alpha = 0.05,   pf = TRUE,   rnd = 3 )"},{"path":"/reference/RRmh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with\r\nsparse data. — RRmh","text":"formula Formula form cbind(y, n) ~ x + cluster(w), y number positive, n group size, x factor two levels treatment, w factor indicating clusters. data data.frame containing variables formula compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. Y Matrix data, \\(K \\times 4\\). row stratum cluster. columns \\(y1, n1, y2, n2\\), y's number positive group, n total group. Group 1 corresponds vaccinates group 2 controls reference. data entered formula dataframe, Y generated automatically. alpha Complement confidence level. pf Estimate RR complement PF? rnd Number digits rounding. Affects display , estimates.","code":""},{"path":"/reference/RRmh.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with\r\nsparse data. — RRmh","text":"object class rr1  following fields. estimate vector point interval estimates:  point estimate, lower confidence limit, upper confidence limit estimator either \"PF\" \"RR\" y data.frame restructured input rnd many digits round display alpha complement confidence level","code":""},{"path":"/reference/RRmh.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with\r\nsparse data. — RRmh","text":"Based Mantel-Haenszel (1959) procedure sparse data developed Greenland Robins (1985). confidence limits based asymptotic normality log(risk ratio).  Agresti Hartzel (2000) favor procedure small, sparse data sets, warn less efficient maximum likelihood large data sets.","code":""},{"path":"/reference/RRmh.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with\r\nsparse data. — RRmh","text":"either y1's y2's zero, division zero may occur, NaN returned values.  Vignette Examples Stratified Designs forthcoming examples.  Call function may one two formats: (1) specify data formula (2) matrix Y RRmh(formula,   data, compare = c('b',''), pf = TRUE, alpha = 0.05, rnd = 3) RRmh(Y, pf = TRUE, alpha = 0.05, rnd = 3)","code":""},{"path":"/reference/RRmh.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with\r\nsparse data. — RRmh","text":"Mantel N, Haenszel W, 1959.  Statistical aspects analysis data retrospective studies disease. Journal National Cancer Institute 22:  719-748.  Greenland S, Robins JM, 1985.  Estimation common effect parameter sparse follow-data. Biometrics  41:  55-68.  Errata, 45:  1323-1324.  Agresti , Hartzel J, 2000.  Strategies comparing treatments binary response multi-centre data.  Statistics Medicine  19:  1115-1139.  Lachin JM, 2000.  Biostatistical Methods:  Assessment Relative Risks (Wiley, New York), Sec. 4.3.1.","code":""},{"path":[]},{"path":"/reference/RRmh.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with\r\nsparse data. — RRmh","text":"PF-package","code":""},{"path":"/reference/RRmh.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mantel-Haenszel method, CI for common RR over strata or clusters with\r\nsparse data. — RRmh","text":"","code":"## Table 1 from Gart (1985) ##  as data frame  # tx group \"b\" is control RRmh(cbind(y, n) ~ tx + cluster(clus),      Table6,      compare = c('a', 'b'), pf = FALSE) #>  #> RR  #> 95% interval estimates #>  #>   RR   LL   UL  #> 2.67 1.37 5.23  #>   # RR # 95% interval estimates # #   RR   LL   UL # 2.67 1.37 5.23 #  ## or as matrix RRmh(Y = table6, pf = FALSE) #>  #> RR  #> 95% interval estimates #>  #>   RR   LL   UL  #> 2.67 1.37 5.23  #>   # RR # 95% interval estimates # #   RR   LL   UL # 2.67 1.37 5.23"},{"path":"/reference/rrmp.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rrmp — rrmp-class","title":"Data class rrmp — rrmp-class","text":"data class rrmp","code":""},{"path":"/reference/rrmp.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rrmp — rrmp-class","text":"[estimate]  vector point interval estimate [estimator]  either \"PF\" \"IDR\" [y]  data vector [rnd]  many digits round display [alpha]  complement c.. [compare]  text vector, input [multvec]  data.frame showing multinomial representation data","code":""},{"path":[]},{"path":"/reference/rrmp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rrmp — rrmp-class","text":"PF-package","code":""},{"path":"/reference/RRmpWald.html","id":null,"dir":"Reference","previous_headings":"","what":"Wald confidence intervals for RR from matched pairs — RRmpWald","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"Estimates confidence intervals risk ratio prevented fraction matched pairs.","code":""},{"path":"/reference/RRmpWald.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"","code":"RRmpWald(   formula = NULL,   data = NULL,   compare = c(\"vac\", \"con\"),   affected = 1,   x,   alpha = 0.05,   pf = TRUE,   tdist = TRUE,   df = NULL,   rnd = 3 )"},{"path":"/reference/RRmpWald.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"formula Formula form y ~ x + cluster(w), y indicator individual's positive response, x factor two levels treatment, w identifies pairs. data data.frame containing variables formula compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. affected Indicator positive response x Alternative data input. Instead formula data frame, data may input frequency vector. See example order vector. alpha Complement confidence level pf Estimate RR complement PF? tdist Use t distribution? df Degrees freedom. NULL, function default df = N - 2, N total number pairs. rnd Number digits rounding. Affects display , estimates.","code":""},{"path":"/reference/RRmpWald.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"rrmp object following fields: estimate vector point interval estimates - see details estimator either \"PF\" \"RR\" compare text vector, input alpha complement confidence level rnd many digits round display multvec data frame showing multinomial representation data","code":""},{"path":"/reference/RRmpWald.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"Estimates confidence intervals risk ratio prevented fraction matched pairs. response tetranomial vector c(11, 12, 21, 22), first index row second index column displayed 2x2 table. Wald type confidence intervals found applying delta method multinomial variance. method fails responders one treatment groups.  Alternative forms data entry illustrated output, say Y, c(Y$xtable) = Y$freqvec = Y$multvec$Freq.  RR = 0 (PF = 1), function return degenerate interval.","code":""},{"path":"/reference/RRmpWald.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"Experimental functions estimating profile likelihood intervals CVBmisc package.  Call function may one two formats: (1) specify data formula (2) vector x RRmpWald(formula, data, compare = c('vac', 'con'),   affected = 1, alpha = 0.05, pf = TRUE, tdist = TRUE, df = NULL,   rnd = 3) RRmpWald(x, compare = c('vac', 'con'), affected =   1, alpha = 0, 05, pf = TRUE, tdist = TRUE, df = NULL, rnd = 3)","code":""},{"path":"/reference/RRmpWald.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"PF-package","code":""},{"path":"/reference/RRmpWald.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wald confidence intervals for RR from matched pairs — RRmpWald","text":"","code":"RRmpWald(pos ~ tx + cluster(cage), New, compare = c('vac', 'con')) #>  #> PF  #> 95% interval estimates #>  #>    PF    LL    UL  #> 0.550 0.183 0.752  #>   # PF # 95% interval estimates # #    PF    LL    UL # 0.550 0.183 0.752  require(magrittr) #> Loading required package: magrittr thistable <- New |>   tidyr::spread(tx, pos) |>   dplyr::mutate(vac = factor(vac, levels = 1:0),     con = factor(con, levels = 1:0)) |>   with(table(vac, con)) thistable #>    con #> vac  1  0 #>   1  7  2 #>   0 13  4 #    con # vac  1  0 #   1  7  2 #   0 13  4 as.vector(thistable) #> [1]  7 13  2  4 # [1]  7 13  2  4  RRmpWald(x = as.vector(thistable)) #>  #> PF  #> 95% interval estimates #>  #>    PF    LL    UL  #> 0.550 0.183 0.752  #>   # PF # 95% interval estimates # #    PF    LL    UL # 0.550 0.183 0.752"},{"path":"/reference/RRor.html","id":null,"dir":"Reference","previous_headings":"","what":"RR estimate from logistic regression. — RRor","title":"RR estimate from logistic regression. — RRor","text":"Model based interval estimate risk ratio prevented fraction logistic regression model.","code":""},{"path":"/reference/RRor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RR estimate from logistic regression. — RRor","text":"","code":"RRor(   fit = NULL,   beta.hat = NULL,   var.beta.hat = NULL,   degf = NULL,   which = c(1, 2),   pf = TRUE,   norm = FALSE,   alpha = 0.05,   rnd = 3 )"},{"path":"/reference/RRor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RR estimate from logistic regression. — RRor","text":"fit glm object. beta.hat Parameters estimates logistic regression intercept. var.beta.hat Variance-covariance matrix logistic regression intercept. degf Degrees freedom. Numeric vector indicating parameters compare, RR = compare[2]/compare[1] pf Estimate RR complement PF? norm Estimate confidence interval using quantiles Guassian rather t distribution quantiles? alpha Complement confidence level. rnd Number digits rounding. Affects display , estimates.","code":""},{"path":"/reference/RRor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RR estimate from logistic regression. — RRor","text":"rror object following fields. estimate vector point interval estimate estimator either PF RR mu matrix rows giving probability estimates groups rnd many digits round display alpha complement confidence level norm logical indicating Gaussian t interval degf degrees freedom","code":""},{"path":"/reference/RRor.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"RR estimate from logistic regression. — RRor","text":"Estimates confidence intervals using delta method parameters generalized linear model logit link. \\(RR={{{\\mu}}_{2}}/{{{\\mu}}_{1}}\\), \\({\\mu}_{}\\) estimated probabilities model.","code":""},{"path":"/reference/RRor.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"RR estimate from logistic regression. — RRor","text":"Call function may one two formats: (1) specify fit (2) beta.hat, var.beta.hat, degf RRor(fit, degf = NULL, pf = TRUE, alpha = 0.05, = c(1, 2), norm   = TRUE, rnd = 3) RRor(beta.hat, var.beta.hat, degf, pf =   TRUE, alpha = 0.05, = c(1, 2), norm = TRUE, rnd = 3)","code":""},{"path":[]},{"path":"/reference/RRor.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"RR estimate from logistic regression. — RRor","text":"PF-package","code":""},{"path":"/reference/RRor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RR estimate from logistic regression. — RRor","text":"","code":"bird.fit <- glm(cbind(y, n - y) ~ tx - 1, binomial, bird) RRor(tauWt(bird.fit)) #> NULL #>  #> 95% t intervals on 4 df #>  #> PF  #>     PF     LL     UL  #>  0.500 -0.583  0.842  #>  #>       mu.hat    LL     UL #> txcon  0.733 0.943 0.3121 #> txvac  0.367 0.752 0.0997  # 95% t intervals on 4 df # # PF #     PF     LL     UL #  0.500 -0.583  0.842 # #       mu.hat    LL     UL # txcon  0.733 0.943 0.3121 # txvac  0.367 0.752 0.0997  RRor(phiWt(bird.fit)) #> NULL #>  #> 95% t intervals on 4 df #>  #> PF  #>     PF     LL     UL  #>  0.500 -0.583  0.842  #>  #>       mu.hat    LL     UL #> txcon  0.733 0.943 0.3121 #> txvac  0.367 0.752 0.0997 # 95% t intervals on 4 df # # PF #     PF     LL     UL #  0.500 -0.583  0.842 # #       mu.hat    LL     UL # txcon  0.733 0.943 0.3121 # txvac  0.367 0.752 0.0997"},{"path":"/reference/rrorclass.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rror — rror-class","title":"Data class rror — rror-class","text":"data class rror","code":""},{"path":"/reference/rrorclass.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rror — rror-class","text":"[estimate]  vector point interval estimate [estimator]  either \"PF\" \"IDR\" [y]  data vector [rnd]  many digits round display [alpha]  complement c.. [norm]  logical indicating Gaussian t interval [degf]  degrees freedom [mu]  matrix rows giving probability estimates groups","code":""},{"path":[]},{"path":"/reference/rrorclass.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rror — rror-class","text":"PF-package","code":""},{"path":"/reference/RRotsst.html","id":null,"dir":"Reference","previous_headings":"","what":"RR exact CI, OTSST method. — RRotsst","title":"RR exact CI, OTSST method. — RRotsst","text":"Estimates confidence interval risk ratio prevented fraction, exact method based score statistic (inverts one two-sided test).","code":""},{"path":"/reference/RRotsst.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RR exact CI, OTSST method. — RRotsst","text":"","code":"RRotsst(   y = NULL,   data = NULL,   formula = NULL,   compare = c(\"vac\", \"con\"),   alpha = 0.05,   pf = TRUE,   stepstart = 0.1,   iter.max = 36,   converge = 1e-06,   rnd = 3,   trace.it = FALSE,   nuisance.points = 120,   gamma = 1e-06 )"},{"path":"/reference/RRotsst.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RR exact CI, OTSST method. — RRotsst","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference). data data.frame containing variables formula. formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment. compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. alpha Complement confidence level. pf Estimate RR complement PF? stepstart starting interval step search iter.max Maximum number iterations converge Convergence criterion rnd Number digits rounding. Affects display , estimates. trace.Verbose tracking iterations? nuisance.points number points evaluate nuisance parameter gamma parameter Berger-Boos correction (restricts range nuisance parameter evaluation)","code":""},{"path":"/reference/RRotsst.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RR exact CI, OTSST method. — RRotsst","text":"object class rr1 following fields: estimate vector point interval estimate estimator either \"PF\" \"RR\" y data.frame \"y1\", \"n1\", \"y2\", \"n2\" values. rnd many digits round display alpha complement confidence level","code":""},{"path":"/reference/RRotsst.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"RR exact CI, OTSST method. — RRotsst","text":"Estimates confidence intervals based score statistic 'exact' sense accounting discreteness. score statistic used select tail area tables, binomial probability estimated tail area taking maximum nuisance parameter. Algorithm simple step search.  data may also matrix. case y entered matrix(c(y1, n1 - y1,   y2, n2 - y2), 2, 2, byrow = TRUE).","code":""},{"path":"/reference/RRotsst.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"RR exact CI, OTSST method. — RRotsst","text":"Koopman PAR, 1984. Confidence intervals ratio two binomial proportions. Biometrics 40:513-517.  Agresti , Min Y, 2001.  small-sample confidence intervals parameters discrete distribution. Biometrics 57: 963-971.  Berger RL, Boos DD, 1994. P values maximized confidence set nuisance parameter. Journal American Statistical Association 89:214-220.","code":""},{"path":[]},{"path":"/reference/RRotsst.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"RR exact CI, OTSST method. — RRotsst","text":"PF-package","code":""},{"path":"/reference/RRotsst.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RR exact CI, OTSST method. — RRotsst","text":"","code":"# All examples represent the same observation, with data entry by multiple # options.  y_vector <- c(4, 24, 12, 28) RRotsst(y_vector, rnd = 3) #>  #> PF  #> 95% interval estimates #>  #>     PF     LL     UL  #> 0.6111 0.0148 0.8519  #>   # PF # 95% interval estimates  #    PF     LL     UL # 0.6111 0.0148 0.8519  y_matrix <- matrix(c(4, 20, 12, 16), 2, 2, byrow = TRUE) RRotsst(y_matrix, rnd = 3) #>  #> PF  #> 95% interval estimates #>  #>     PF     LL     UL  #> 0.6111 0.0148 0.8519  #>   # PF # 95% interval estimates  #    PF     LL     UL # 0.6111 0.0148 0.8519  require(dplyr) data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 2),   y = c(1, 3, 7, 5),   n = c(12, 12, 14, 14),   cage = rep(paste('cage', 1:2), 2))  data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),     sum_n = sum(n)) RRotsst(data = data2, formula =  cbind(sum_y, sum_n) ~ group,    compare = c(\"treated\", \"control\")) #>  #> PF  #> 95% interval estimates #>  #>     PF     LL     UL  #> 0.6111 0.0148 0.8519  #>   # PF # 95% interval estimates # # PF     LL     UL # 0.6111 0.0148 0.8519"},{"path":"/reference/RRsc.html","id":null,"dir":"Reference","previous_headings":"","what":"RR score based asymptotic CI. — RRsc","title":"RR score based asymptotic CI. — RRsc","text":"Estimates confidence intervals risk ratio prevented fraction based score statistic.","code":""},{"path":"/reference/RRsc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RR score based asymptotic CI. — RRsc","text":"","code":"RRsc(   y = NULL,   data = NULL,   formula = NULL,   compare = c(\"vac\", \"con\"),   alpha = 0.05,   pf = TRUE,   trace.it = FALSE,   iter.max = 18,   converge = 1e-06,   rnd = 3 )"},{"path":"/reference/RRsc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RR score based asymptotic CI. — RRsc","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference group). data data.frame containing variables formula. formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment. compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. alpha Complement confidence level. pf Estimate RR complement PF? trace.Verbose tracking iterations? iter.max Maximum number iterations converge Convergence criterion rnd Number digits rounding. Affects display , estimates.","code":""},{"path":"/reference/RRsc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RR score based asymptotic CI. — RRsc","text":"rrsc object following fields. estimate matrix point interval estimates - see details estimator either \"PF\" \"RR\" y data.frame \"y1\", \"n1\", \"y2\", \"n2\" values. rnd many digits round display alpha complement confidence level","code":""},{"path":"/reference/RRsc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"RR score based asymptotic CI. — RRsc","text":"Estimates returned three estimators based score statistic. score method introduced Koopman (1984). Gart Nam's modification (1988) includes skewness correction. method Miettinen Nurminen (1985) version made slightly conservative Koopman's including factor (N-1)/N. starting estimate DUD algorithm obtained modified Katz method (log method 0.5 added cell). forms Katz estimate may retrieved returned object using RRsc()$estimate.  data may also matrix. case y entered matrix(c(y1, n1-y1, y2, n2-y2), 2, 2, byrow = TRUE).","code":""},{"path":"/reference/RRsc.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"RR score based asymptotic CI. — RRsc","text":"Gart JJ, Nam J, 1988. Approximate interval estimation ratio binomial parameters: review corrections skewness. Biometrics 44:323-338.  Koopman PAR, 1984. Confidence intervals ratio two binomial proportions. Biometrics 40:513-517.  Miettinen O, Nurminen M, 1985. Comparative analysis two rates. Statistics Medicine 4:213-226.  Ralston ML, Jennrich RI, 1978. DUD, Derivative-Free Algorithm Nonlinear Least Squares. Technometrics 20:7-14.","code":""},{"path":[]},{"path":"/reference/RRsc.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"RR score based asymptotic CI. — RRsc","text":"PF-package","code":""},{"path":"/reference/RRsc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RR score based asymptotic CI. — RRsc","text":"","code":"# All examples represent the same observation, with data entry by using # multiple notation options.  y_vector <- c(4, 24, 12, 28) RRsc(y_vector) #>  #> PF  #> 95% interval estimates #>  #>                 PF     LL    UL #> MN method    0.611 0.0251 0.857 #> score method 0.611 0.0328 0.855 #> skew corr    0.611 0.0380 0.876 #>   # PF # 95% interval estimates  #         PF     LL    UL # MN method    0.611 0.0251 0.857 # score method 0.611 0.0328 0.855 # skew corr    0.611 0.0380 0.876  y_matrix <- matrix(c(4, 20, 12, 16), 2, 2, byrow = TRUE) #       [, 1] [, 2] # [1, ]    4   20 # [2, ]   12   16  RRsc(y_matrix) #>  #> PF  #> 95% interval estimates #>  #>                 PF     LL    UL #> MN method    0.611 0.0251 0.857 #> score method 0.611 0.0328 0.855 #> skew corr    0.611 0.0380 0.876 #>   # PF # 95% interval estimates  #         PF     LL    UL # MN method    0.611 0.0251 0.857 # score method 0.611 0.0328 0.855 # skew corr    0.611 0.0380 0.876 require(dplyr) data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 2),   y = c(1, 3, 7, 5),   n = c(12, 12, 14, 14),   cage = rep(paste('cage', 1:2), 2))  data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),     sum_n = sum(n)) RRsc(data = data2, formula = cbind(sum_y, sum_n) ~ group,   compare = c(\"treated\", \"control\")) #>  #> PF  #> 95% interval estimates #>  #>                 PF     LL    UL #> MN method    0.611 0.0251 0.857 #> score method 0.611 0.0328 0.855 #> skew corr    0.611 0.0380 0.876 #>   # PF # 95% interval estimates  #         PF     LL    UL # MN method    0.611 0.0251 0.857 # score method 0.611 0.0328 0.855 # skew corr    0.611 0.0380 0.876"},{"path":"/reference/rrscclass.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rrsc — rrsc-class","title":"Data class rrsc — rrsc-class","text":"data class rrsc","code":""},{"path":"/reference/rrscclass.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rrsc — rrsc-class","text":"[estimate]  vector point interval estimate [rnd]  many digits round display [alpha]  complement c.. [estimator]  either \"PF\" \"RR\" [y] data.frame restructured input","code":""},{"path":[]},{"path":"/reference/rrscclass.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rrsc — rrsc-class","text":"PF-package","code":""},{"path":"/reference/rrsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rrsi — rrsi-class","title":"Data class rrsi — rrsi-class","text":"data class rrsi","code":""},{"path":"/reference/rrsi.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rrsi — rrsi-class","text":"[y] data.frame restructured input [k]  likelihood ratio criterion [rnd]  digits round display [alpha]  complement c.. [estimate]  vector point interval estimate [estimator]  either \"PF\" \"IDR\"","code":""},{"path":[]},{"path":"/reference/rrsi.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rrsi — rrsi-class","text":"PF-package","code":""},{"path":"/reference/RRstr.html","id":null,"dir":"Reference","previous_headings":"","what":"Gart-Nam method, CI for common RR over strata or clusters. — RRstr","title":"Gart-Nam method, CI for common RR over strata or clusters. — RRstr","text":"Estimates confidence intervals risk ratio prevented fraction clustered stratified data.","code":""},{"path":"/reference/RRstr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gart-Nam method, CI for common RR over strata or clusters. — RRstr","text":"","code":"RRstr(   formula = NULL,   data = NULL,   compare = c(\"vac\", \"con\"),   Y,   alpha = 0.05,   pf = TRUE,   trace.it = FALSE,   iter.max = 24,   converge = 1e-06,   rnd = 3,   multiplier = 0.7,   divider = 1.1 )"},{"path":"/reference/RRstr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gart-Nam method, CI for common RR over strata or clusters. — RRstr","text":"formula Formula form cbind(y, n) ~ x + cluster(w), y number positive, n group size, x factor two levels treatment, w factor indicating clusters. data data.frame containing variables formula compare Text vector stating factor levels: compare[1] control reference group compare[2] compared Y Matrix data. row stratum cluster. columns y2, n2, y1, n1. data entered formula dataframe, Y generated automatically. alpha Size homogeneity test complement confidence level. pf Estimate RR complement PF? trace.verbose tracking iterations? iter.max Maximum number iterations converge Convergence criterion rnd Number digits rounding. Affects display , estimates. multiplier internal control parameter algorithm divider internal control parameter algorithm","code":""},{"path":"/reference/RRstr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gart-Nam method, CI for common RR over strata or clusters. — RRstr","text":"rrstr object following fields: estimate matrix point interval estimates - starting value, MLE, skewness corrected hom list homogeneity statistic, p-value, degrees freedom, error message appropriate. estimator either \"PF\" \"RR\" y data.frame restructured input compare groups compared rnd many digits round display alpha size test; complement confidence level","code":""},{"path":"/reference/RRstr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Gart-Nam method, CI for common RR over strata or clusters. — RRstr","text":"Uses DUD algorithm estimate confidence intervals method Gart.","code":""},{"path":"/reference/RRstr.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Gart-Nam method, CI for common RR over strata or clusters. — RRstr","text":"Vignette Examples Stratified Designs forthcoming examples. Call function may one two formats: (1) specify data formula (2) matrix Y RRstr(formula, data, compare = c('b',''), pf = TRUE, alpha = 0.05,   trace.= FALSE,  iter.max = 24, converge = 1e-6, rnd = 3, multiplier = 0.7, divider = 1.1) RRstr(Y, compare = c('b',''), pf =   TRUE, alpha = 0.05, trace.= FALSE, iter.max = 24, converge =   1e-6, rnd = 3, multiplier = 0.7, divider = 1.1)","code":""},{"path":"/reference/RRstr.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Gart-Nam method, CI for common RR over strata or clusters. — RRstr","text":"Gart JJ, 1985. Approximate tests interval estimation common relative risk combination \\(2 x 2\\) tables. Biometrika 72:673-677.  Gart JJ, Nam J, 1988. Approximate interval estimation ratio binomial parameters: review corrections skewness. Biometrics 44:323-338.  Ralston ML, Jennrich RI, 1978. DUD, Derivative-Free Algorithm Nonlinear Least Squares. Technometrics 20:7-14.","code":""},{"path":[]},{"path":"/reference/RRstr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Gart-Nam method, CI for common RR over strata or clusters. — RRstr","text":"PF-package","code":""},{"path":"/reference/RRstr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gart-Nam method, CI for common RR over strata or clusters. — RRstr","text":"","code":"## Table 1 from Gart (1985) ##  as data frame ## \"b\" is control group RRstr(cbind(y, n) ~ tx + cluster(clus),       Table6,       compare = c('a', 'b'), pf = FALSE) #>  #> Test of homogeneity across clusters #>  #> stat\t 0.954  #> df\t 3  #> p\t 0.812  #>  #> RR  #> 95% interval estimates #>  #>             RR   LL   UL #> starting  2.66 1.37 5.18 #> mle       2.65 1.39 5.03 #> skew corr 2.65 1.31 5.08 #>   # Test of homogeneity across clusters  # stat     0.954 # df       3 # p        0.812  #  RR estimates  #             RR   LL   UL # starting   2.66 1.37 5.18 # mle        2.65 1.39 5.03 # skew corr  2.65 1.31 5.08  ## or as matrix RRstr(Y = table6, pf = FALSE) #>  #> Test of homogeneity across clusters #>  #> stat\t 0.954  #> df\t 3  #> p\t 0.812  #>  #> RR  #> 95% interval estimates #>  #>             RR   LL   UL #> starting  2.66 1.37 5.18 #> mle       2.65 1.39 5.03 #> skew corr 2.65 1.31 5.08 #>   tst <- data.frame(y = c(0, 2, 0, 4, 0, 3, 0, 7), n = rep(10, 8), tx = rep(c('a', 'b'), 4), clus = rep(paste('Row', 1:4, sep = ''), each = 2))"},{"path":"/reference/rrstrclass.html","id":null,"dir":"Reference","previous_headings":"","what":"Data class rrstr — rrstr-class","title":"Data class rrstr — rrstr-class","text":"data class rrstr","code":""},{"path":"/reference/rrstrclass.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"Data class rrstr — rrstr-class","text":"[estimate]  vector point interval estimate [rnd]  many digits round display [alpha]  complement c.. [estimator]  either \"PF\" \"RR\" [hom]list homogeneity statistic, p-value, degrees freedom. Phi == 0 | Phi == 1, homogeneity test possible error message displays [y]data.frame restructured input [compare]  groups compared","code":""},{"path":[]},{"path":"/reference/rrstrclass.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Data class rrstr — rrstr-class","text":"PF-package","code":""},{"path":"/reference/RRtosst.html","id":null,"dir":"Reference","previous_headings":"","what":"RR exact CI, TOSST method. — RRtosst","title":"RR exact CI, TOSST method. — RRtosst","text":"Estimates confidence interval risk ratio prevented fraction; exact method based score statistic (inverts two one-sided tests).","code":""},{"path":"/reference/RRtosst.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RR exact CI, TOSST method. — RRtosst","text":"","code":"RRtosst(   y = NULL,   formula = NULL,   data = NULL,   compare = c(\"vac\", \"con\"),   alpha = 0.05,   pf = TRUE,   stepstart = 0.1,   iter.max = 36,   converge = 1e-06,   rnd = 3,   trace.it = FALSE,   nuisance.points = 120,   gamma = 1e-06 )"},{"path":"/reference/RRtosst.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RR exact CI, TOSST method. — RRtosst","text":"y Data vector c(y1, n1, y2, n2) y positives, n total, group 1 compared group 2 (control reference group). formula Formula form cbind(y, n) ~ x, y number positive, n group size, x factor two levels treatment. data data.frame containing variables formula. compare Text vector stating factor levels: compare[1] vaccinate group compare[2] (control reference) compared. alpha Complement confidence level. pf Estimate RR complement PF? stepstart starting interval step search iter.max Maximum number iterations converge Convergence criterion rnd Number digits rounding. Affects display , estimates. trace.Verbose tracking iterations? nuisance.points number points evaluate nuisance parameter gamma parameter Berger-Boos correction (restricts range nuisance parameter evaluation)","code":""},{"path":"/reference/RRtosst.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RR exact CI, TOSST method. — RRtosst","text":"rr1 object following fields. estimate vector point interval estimate estimator either \"PF\" \"RR\" y data.frame \"y1\", \"n1\", \"y2\", \"n2\" values. rnd many digits round display alpha complement confidence level","code":""},{"path":"/reference/RRtosst.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"RR exact CI, TOSST method. — RRtosst","text":"Estimates confidence intervals based score statistic 'exact' sense accounting discreteness. Inverts two one-sided score tests. score statistic used select tail area tables, binomial probability estimated tail area taking maximum nuisance parameter. Algorithm simple step search.  data may also matrix. case y entered matrix(c(y1, n1-y1, y2, n2-y2), 2, 2, byrow = TRUE).","code":""},{"path":"/reference/RRtosst.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"RR exact CI, TOSST method. — RRtosst","text":"Koopman PAR, 1984. Confidence intervals ratio two binomial proportions. Biometrics 40:513-517.  Agresti , Min Y, 2001.  small-sample confidence intervals parameters discrete distribution. Biometrics 57: 963-971.  Berger RL, Boos DD, 1994. P values maximized confidence set nuisance parameter. Journal American Statistical Association 89:214-220.","code":""},{"path":[]},{"path":"/reference/RRtosst.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"RR exact CI, TOSST method. — RRtosst","text":"PF-package","code":""},{"path":"/reference/RRtosst.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RR exact CI, TOSST method. — RRtosst","text":"","code":"# Both examples represent the same observation, with data entry by vector # and matrix notation.  y_vector <- c(4, 24, 12, 28) RRtosst(y_vector) #>  #> PF  #> 95% interval estimates #>  #>    PF    LL    UL  #> 0.611 0.012 0.902  #>   # PF # 95% interval estimates  #    PF    LL    UL # 0.611 0.012 0.902  y_matrix <- matrix(c(4, 20, 12, 16), 2, 2, byrow = TRUE) #      [, 1] [, 2] # [1, ]    4   20 # [2, ]   12   16  RRtosst(y_matrix) #>  #> PF  #> 95% interval estimates #>  #>    PF    LL    UL  #> 0.611 0.012 0.902  #>   # PF # 95% interval estimates  #    PF    LL    UL # 0.611 0.012 0.902  require(dplyr) data1 <- data.frame(group = rep(c(\"treated\", \"control\"), each = 2),   y = c(1, 3, 7, 5),   n = c(12, 12, 14, 14),   cage = rep(paste('cage', 1:2), 2)) data2 <- data1 |>   group_by(group) |>   summarize(sum_y = sum(y),     sum_n = sum(n)) RRtosst(data = data2, formula =  cbind(sum_y, sum_n) ~ group,   compare = c(\"treated\", \"control\")) #>  #> PF  #> 95% interval estimates #>  #>    PF    LL    UL  #> 0.611 0.012 0.902  #>   # PF # 95% interval estimates  #    PF    LL    UL # 0.611 0.012 0.902"},{"path":"/reference/rsb.html","id":null,"dir":"Reference","previous_headings":"","what":"Rao-Scott weights. — rsb","title":"Rao-Scott weights. — rsb","text":"Rao-Scott weights.","code":""},{"path":"/reference/rsb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rao-Scott weights. — rsb","text":"","code":"rsb(y = NULL, n = NULL, formula = NULL, data = NULL, id = NULL)"},{"path":"/reference/rsb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rao-Scott weights. — rsb","text":"y vector number positive. n vector total number. formula Formula form cbind(y, n) ~ id, y number positive, n total number, id factor estimating weights subset. data data.frame containing variables formula. id vector factor estimating weights subset.","code":""},{"path":"/reference/rsb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rao-Scott weights. — rsb","text":"list following elements. w vector weights d vector \\({d}_{}\\) estimates","code":""},{"path":"/reference/rsb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rao-Scott weights. — rsb","text":"Estimates cluster design effect \\({d}_{}\\) variance inflation due clustering method Rao Scott. rsb estimates \\({d}_{}\\) use rsbWt functions.","code":""},{"path":"/reference/rsb.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rao-Scott weights. — rsb","text":"Rao JNK, Scott AJ, 1992. simple method analysis clustered binary data. Biometrics 48:577-585.","code":""},{"path":[]},{"path":"/reference/rsb.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Rao-Scott weights. — rsb","text":"PF-package","code":""},{"path":"/reference/rsb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rao-Scott weights. — rsb","text":"","code":"# Weil's rat data (Table 1 of Rao and Scott) rsb(rat$y, rat$n, id = rat$group)$d #>  control  treated  #> 1.232495 3.952861  #  control  treated # 1.232495 3.952861 rsb(data = rat, formula = cbind(y, n) ~ group)$d #>  control  treated  #> 1.232495 3.952861  #  control  treated # 1.232495 3.952861"},{"path":"/reference/rsbWt.html","id":null,"dir":"Reference","previous_headings":"","what":"Rao-Scott weighting. — rsbWt","title":"Rao-Scott weighting. — rsbWt","text":"Rao-Scott weighting clustered binomial observations.","code":""},{"path":"/reference/rsbWt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rao-Scott weighting. — rsbWt","text":"","code":"rsbWt(fit = NULL, subset.factor = NULL, fit.only = TRUE)"},{"path":"/reference/rsbWt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rao-Scott weighting. — rsbWt","text":"fit glm object. subset.factor Factor estimating weights subset. fit.Return new fit? FALSE, also returns weights phi estimates.","code":""},{"path":"/reference/rsbWt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Rao-Scott weighting. — rsbWt","text":"list following elements. fit new model fit, updated estimated weights weights vector weights d vector \\({d}_{}\\) estimates","code":""},{"path":"/reference/rsbWt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rao-Scott weighting. — rsbWt","text":"Estimates cluster design effect \\({d}_{}\\) variance inflation due clustering method Rao Scott. Observations weighted inverse \\({d}_{}\\).","code":""},{"path":"/reference/rsbWt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rao-Scott weighting. — rsbWt","text":"Rao JNK, Scott AJ, 1992. simple method analysis clustered binary data. Biometrics 48:577-585.","code":""},{"path":[]},{"path":"/reference/rsbWt.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Rao-Scott weighting. — rsbWt","text":"PF-package","code":""},{"path":"/reference/rsbWt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rao-Scott weighting. — rsbWt","text":"","code":"birdm.fit <- glm(cbind(y,n-y)~tx-1,binomial,birdm) RRor(rsbWt(birdm.fit)) #> NULL #>  #> 95% t intervals on 4 df #>  #> PF  #>     PF     LL     UL  #>  0.479 -1.061  0.868  #>  #>       mu.hat    LL     UL #> txcon  0.768 0.968 0.2659 #> txvac  0.400 0.848 0.0737 # # 95% t intervals on 4 df # # PF #     PF     LL     UL #  0.479 -1.061  0.868 # #       mu.hat    LL     UL # txcon  0.768 0.968 0.2659 # txvac  0.400 0.848 0.0737 #"},{"path":"/reference/set1.html","id":null,"dir":"Reference","previous_headings":"","what":"set1 dataset — set1","title":"set1 dataset — set1","text":"set1 dataset","code":""},{"path":"/reference/set1.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"set1 dataset — set1","text":"3 x 4 matrix data Set1","code":""},{"path":"/reference/set1.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"set1 dataset — set1","text":"need references!","code":""},{"path":"/reference/table6.html","id":null,"dir":"Reference","previous_headings":"","what":"table6 dataset — table6","title":"table6 dataset — table6","text":"table6 dataset","code":""},{"path":"/reference/table6.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"table6 dataset — table6","text":"matrix data Table6","code":""},{"path":"/reference/tauWt.html","id":null,"dir":"Reference","previous_headings":"","what":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"MME estimates binomial dispersion parameter tau (intra-cluster correlation).","code":""},{"path":"/reference/tauWt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"","code":"tauWt(   fit,   subset.factor = NULL,   fit.only = TRUE,   iter.max = 12,   converge = 1e-06,   trace.it = FALSE )"},{"path":"/reference/tauWt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"fit glm object. subset.factor Factor estimating tau subset. fit.Return final fit?  FALSE, also returns weights tau estimates. iter.max Maximum number iterations. converge Convergence criterion: difference model degrees freedom Pearson's chi-square. Default 1e-6. trace.Display print statments indicating progress","code":""},{"path":"/reference/tauWt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"list following elements. fit new model fit, updated estimated weights weights vector weights phi vector phi estimates","code":""},{"path":"/reference/tauWt.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"Estimates binomial dispersion parameter \\(\\tau\\) method moments. Iteratively refits model Williams procedure, weighting observations \\(1/\\phi_{ij}\\), \\(\\phi_{ij}=1+\\tau _j(n_{ij}-1)\\), \\(j\\) indexes subsets, \\(\\) indexes observations.","code":""},{"path":"/reference/tauWt.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"Williams DA, 1982. Extra-binomial variation logistic linear models. Applied Statistics 31:144-148.  Wedderburn RWM, 1974. Quasi-likelihood functions, generalized linear models, Gauss-Newton method. Biometrika 61:439-447.","code":""},{"path":[]},{"path":"/reference/tauWt.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"PF-package","code":""},{"path":"/reference/tauWt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Binomial dispersion: intra-cluster correlation parameter. — tauWt","text":"","code":"birdm.fit <- glm(cbind(y,n-y)~tx-1, binomial, birdm) RRor(tauWt(birdm.fit)) #> NULL #>  #> 95% t intervals on 4 df #>  #> PF  #>     PF     LL     UL  #>  0.489 -0.578  0.835  #>  #>       mu.hat    LL    UL #> txcon  0.737 0.944 0.320 #> txvac  0.376 0.758 0.104  # 95% t intervals on 4 df # # PF #     PF     LL     UL #  0.489 -0.578  0.835 # #       mu.hat    LL    UL # txcon  0.737 0.944 0.320 # txvac  0.376 0.758 0.104 #"}]
