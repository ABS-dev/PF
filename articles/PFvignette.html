<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>PF Vignette • PF</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PF Vignette">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PF</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">9.6.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/PFvignette.html">PF Vignette</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/ABS-dev/PF/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>PF Vignette</h1>
                        <h4 data-toc-skip class="author">David Siev, Christopher H. Tong</h4>
            
            <h4 data-toc-skip class="date">January 4, 2012</h4>
      

      <div class="d-none name"><code>PFvignette.rmd</code></div>
    </div>

    
    
<div class="section level2" number="1">
<h2 id="introduction">
<span class="header-section-number">1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>PF</code> package is a collection of functions related to estimating prevented fraction, <span class="math inline">\(PF=1-RR\)</span> ,
where <span class="math inline">\(RR={{{\pi}_{2}}}/{{{\pi}_{1}}}\;\)</span> .</p>
<div class="section level3" number="1.1">
<h3 id="technical-notes">
<span class="header-section-number">1.1</span> Technical notes<a class="anchor" aria-label="anchor" href="#technical-notes"></a>
</h3>
<p><em>Optimization</em>. Unless otherwise stated, optimization is by the DUD algorithm <span class="citation">(Ralston and Jennrich 1978)</span>.</p>
<p><em>Level tested</em>. The help files indicate the level of testing undergone by each function. In some cases that is a subjective judgement, since most of these functions were originally tested in SPlus and have been ported to R more recently.</p>
</div>
</div>
<div class="section level2" number="2">
<h2 id="score-based-methods">
<span class="header-section-number">2</span> Score based methods<a class="anchor" aria-label="anchor" href="#score-based-methods"></a>
</h2>
<div class="section level3" number="2.1">
<h3 id="the-score-statistic">
<span class="header-section-number">2.1</span> The score statistic<a class="anchor" aria-label="anchor" href="#the-score-statistic"></a>
</h3>
<p>Confidence intervals for the risk ratio may be based on the score statistic <span class="citation">Miettinen and Nurminen (1985)</span>,
<span class="math display">\[\frac{{{{\hat{\pi }}}_{2}}-{{\rho }_{0}}{{{\hat{\pi }}}_{1}}}{\sqrt{\left( {{{{\tilde{\pi }}}_{2}}(1-{{{\tilde{\pi }}}_{2}})}/{{{n}_{2}}}\; \right)+\rho _{0}^{2}\left( {{{{\tilde{\pi }}}_{1}}(1-{{{\tilde{\pi }}}_{1}})}/{{{n}_{1}}}\; \right)}}\]</span>
where hat indicates the MLE and tilde indicates the MLE under the restriction that <span class="math inline">\(\rho ={{\rho }_{0}}\)</span>.</p>
</div>
<div class="section level3" number="2.2">
<h3 id="asymptotic-intervals">
<span class="header-section-number">2.2</span> Asymptotic intervals<a class="anchor" aria-label="anchor" href="#asymptotic-intervals"></a>
</h3>
<p><code><a href="../reference/RRsc.html">RRsc()</a></code> estimates asymptotic confidence intervals for the risk ratio or prevented fraction based on the score statistic.
Interval estimates are returned for three estimators. The score method was originally introduced by <span class="citation">(Koopman 1984)</span>. Gart and Nam’s modification includes a skewness correction <span class="citation">(Gart and Nam 1988)</span>. The method of <span class="citation">(Miettinen and Nurminen 1985)</span> is a version made slightly more conservative than Koopman’s by including a factor of <span class="math inline">\({(N-1)}/{N}\;\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ABS-dev/PF/">PF</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: PF</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/RRsc.html">RRsc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">24</span>, <span class="fl">12</span>, <span class="fl">28</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">## 95% interval estimates</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 PF     LL    UL</span></span>
<span><span class="co">## MN method    0.611 0.0251 0.857</span></span>
<span><span class="co">## score method 0.611 0.0328 0.855</span></span>
<span><span class="co">## skew corr    0.611 0.0380 0.876</span></span></code></pre>
<p>Starting estimates for the algorithm are obtained by the modified Katz method (log method with 0.5 added to each cell).
Both forms of the Katz estimate may be retrieved from the returned object using <code>RRsc()\$estimate</code>.</p>
</div>
<div class="section level3" number="2.3">
<h3 id="exact-intervals">
<span class="header-section-number">2.3</span> Exact intervals<a class="anchor" aria-label="anchor" href="#exact-intervals"></a>
</h3>
<p>These methods give intervals that are `exact’ in the sense that they are based on the actual sampling distribution rather than an approximation to it.
The score statistic is used to select the <span class="math inline">\(2 \times 2\)</span> tables that would fall in the tail area, and the binomial probability is
estimated over the tail area by taking the maximum over the nuisance parameter. The search over the tail area is made more efficient
by the Berger-Boos correction <span class="citation">(Berger and Boos 1994)</span>.</p>
<p><code><a href="../reference/RRtosst.html">RRtosst()</a></code> gives intervals obtained by inverting two one-sided score tests; <code><a href="../reference/RRotsst.html">RRotsst()</a></code> gives intervals obtained by inverting one two-sided score test. <code><a href="../reference/RRtosst.html">RRtosst()</a></code> is thus more conservative, preserving at least <span class="math inline">\({\alpha }/{2}\;\)</span> in each tail.
<span class="citation">(Agresti and Min 2001)</span> discuss the properties and relative benefits of the two approaches. The price of exactnesss is conservatism, due to the discreteness of the binomial distribution <span class="citation">(Agresti 2001)</span>. This means that the actual coverage of the confidence interval does not exactly conform to the nominal coverage, but it will not be less than it. (See also <span class="citation">(Agresti 2003)</span>.) Both functions use a simple step search algorithm.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/RRotsst.html">RRotsst</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">24</span>, <span class="fl">12</span>, <span class="fl">28</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">## 95% interval estimates</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     PF     LL     UL </span></span>
<span><span class="co">## 0.6111 0.0148 0.8519</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/RRtosst.html">RRtosst</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">24</span>, <span class="fl">12</span>, <span class="fl">28</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">## 95% interval estimates</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    PF    LL    UL </span></span>
<span><span class="co">## 0.611 0.012 0.902</span></span></code></pre>
</div>
</div>
<div class="section level2" number="3">
<h2 id="stratified-designs">
<span class="header-section-number">3</span> Stratified designs<a class="anchor" aria-label="anchor" href="#stratified-designs"></a>
</h2>
<p>Methods for estimating a common <em>RR</em> from stratified or clustered designs depend on homogeneity with respect to the common parameter.</p>
<div class="section level3" number="3.1">
<h3 id="gart-nam-score-method">
<span class="header-section-number">3.1</span> Gart-Nam score method<a class="anchor" aria-label="anchor" href="#gart-nam-score-method"></a>
</h3>
<p><span class="citation">(Gart 1985)</span> and <span class="citation">(Gart and Nam 1988)</span> derived a score statistic for a common estimate of <em>RR</em> from designs with multiple independent strata, and they showed that it is identical to one proposed by <span class="citation">(Radhakrishnan 1965)</span> from a different perspective.</p>
<p><code><a href="../reference/RRstr.html">RRstr()</a></code> provides confidence intervals and a homogeneity test based on Gart’s statistic.</p>
<p>Data may be input two ways, either using a formula and data frame, or as a matrix.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/RRstr.html">RRstr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">n</span><span class="op">)</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="fu">cluster</span><span class="op">(</span><span class="va">clus</span><span class="op">)</span>, <span class="va">Table6</span>,</span>
<span>      compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, pf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Test of homogeneity across clusters</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## stat  0.954 </span></span>
<span><span class="co">## df    3 </span></span>
<span><span class="co">## p     0.812 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## RR </span></span>
<span><span class="co">## 95% interval estimates</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##             RR   LL   UL</span></span>
<span><span class="co">## starting  2.66 1.37 5.18</span></span>
<span><span class="co">## mle       2.65 1.39 5.03</span></span>
<span><span class="co">## skew corr 2.65 1.31 5.08</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data matrix input: RRstr(Y = table6, pf = F)</span></span></code></pre></div>
</div>
<div class="section level3" number="3.2">
<h3 id="mantel-haenszel-estimator">
<span class="header-section-number">3.2</span> Mantel-Haenszel estimator<a class="anchor" aria-label="anchor" href="#mantel-haenszel-estimator"></a>
</h3>
<p>A widely-used heuristic method for sparse frequency tables is the weighted average approach of <span class="citation">(Mantel and Haenszel 1959)</span><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;span class="citation"&gt;(Kuritz, Landis, and Koch 1988)&lt;/span&gt; review the Mantel-Haenzel approach and point out its relationship to a method proposed by &lt;span class="citation"&gt;(Cochran 1954)&lt;/span&gt;, which was the basis of Rhadakrishnan’s method &lt;span class="citation"&gt;(Radhakrishnan 1965)&lt;/span&gt;, alluded to in Section 3.1.&lt;/p&gt;'><sup>1</sup></a>. MH interval estimates are based on the asymptotic normality of the log of the risk ratio.
<code><a href="../reference/RRmh.html">RRmh()</a></code> utilizes the variance estimator given by <span class="citation">(Greenland and Robins 1985)</span> for sparse strata.
The resulting asymptotic estimator is consistent for both the case of sparse strata where the number of strata is assumed increasing,
and the case of limited number of strata where the stratum size is assumed increasing. In the latter case, however, it is less
efficient than maximum likelihood <span class="citation">Greenland and Robins (1985)</span>.
Additional discussion may be found in Section 4.3.1 <span class="citation">(Lachin 2000)</span>, <span class="citation">(Landis et al. 2005)</span>, and <span class="citation">(Somes and O’Brien 2006)</span>
<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;SAS Proc FREQ provides MH interval estimates of &lt;em&gt;RR&lt;/em&gt;. The other estimator calculated by Proc FREQ, which it calls
``logit,’’ is actually a weighted least squares estimator &lt;span class="citation"&gt;(Lachin 2000)&lt;/span&gt; that has a demonstrable and severe
bias for sparse data &lt;span class="citation"&gt;(Greenland and Robins 1985)&lt;/span&gt;. It should be avoided.&lt;/p&gt;'><sup>2</sup></a>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/RRmh.html">RRmh</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">n</span><span class="op">)</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="fu">cluster</span><span class="op">(</span><span class="va">clus</span><span class="op">)</span>, <span class="va">Table6</span>,</span>
<span>     compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, pf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## RR </span></span>
<span><span class="co">## 95% interval estimates</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   RR   LL   UL </span></span>
<span><span class="co">## 2.67 1.37 5.23</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data matrix input: RRmh(Y = table6, pf = F)</span></span></code></pre></div>
</div>
<div class="section level3" number="3.3">
<h3 id="examples">
<span class="header-section-number">3.3</span> Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>For a fuller set of examples, see the vignette <em>Examples for Stratified Designs</em>.</p>
</div>
</div>
<div class="section level2" number="4">
<h2 id="model-based-intervals">
<span class="header-section-number">4</span> Model based intervals<a class="anchor" aria-label="anchor" href="#model-based-intervals"></a>
</h2>
<div class="section level3" number="4.1">
<h3 id="logistic-regression-estimates">
<span class="header-section-number">4.1</span> Logistic regression estimates<a class="anchor" aria-label="anchor" href="#logistic-regression-estimates"></a>
</h3>
<p>Intervals may be estimated from logistic regression models with <code><a href="../reference/RRor.html">RRor()</a></code>. It takes the fit of a <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> object and estimates the intervals by the delta method.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bird.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">n</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">binomial</span>, <span class="va">bird</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/RRor.html">RRor</a></span><span class="op">(</span><span class="va">bird.fit</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 95% t intervals on 4 df</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">##      PF      LL      UL </span></span>
<span><span class="co">##  0.5000 -0.0406  0.7598 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       mu.hat    LL    UL</span></span>
<span><span class="co">## txcon  0.733 0.896 0.466</span></span>
<span><span class="co">## txvac  0.367 0.624 0.168</span></span></code></pre>
</div>
<div class="section level3" number="4.2">
<h3 id="estimating-the-dispersion-parameter">
<span class="header-section-number">4.2</span> Estimating the dispersion parameter<a class="anchor" aria-label="anchor" href="#estimating-the-dispersion-parameter"></a>
</h3>
<p>The binomial GLM weights are
<span class="math display">\[\frac{\hat{\pi }(1-\hat{\pi })}{a(\hat{\varphi })/n\;}\]</span>
where <span class="math inline">\(a(\hat{\varphi })\)</span> is a function of the dispersion parameter.</p>
<div class="section level4" number="4.2.1">
<h4 id="dispersion-parameter-varphi">
<span class="header-section-number">4.2.1</span> Dispersion parameter <span class="math inline">\(\varphi\)</span><a class="anchor" aria-label="anchor" href="#dispersion-parameter-varphi"></a>
</h4>
<p>A simple estimator of the dispersion parameter, <span class="math inline">\(\varphi\)</span>, may be estimated by the method of moments [Wed74]. It is given by <code><a href="../reference/phiWt.html">phiWt()</a></code>.
This form of the dispersion parameter has <span class="math inline">\(a(\varphi)=\varphi\)</span>, and <span class="math inline">\(\varphi\)</span> is estimated by <span class="math inline">\({X^2}/{df}\;\)</span>, the Pearson statistic divided by the degrees of freedom.</p>
<p>Note that <span class="math inline">\(\varphi\)</span> is the same estimator as may be obtained by the <code>quasibinomial</code> family in <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> which is, in fact, what is used by <code><a href="../reference/phiWt.html">phiWt()</a></code> to reweight the original fit:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/phiWt.html">phiWt</a></span><span class="op">(</span><span class="va">bird.fit</span>, fit.only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">phi</span></span></code></pre></div>
<pre><code><span><span class="co">##      all </span></span>
<span><span class="co">## 2.471592</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">bird.fit</span>, family <span class="op">=</span> <span class="va">quasibinomial</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">disp</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.471592</span></span></code></pre>
<p><code><a href="../reference/phiWt.html">phiWt()</a></code> makes it easy to estimate <em>PF</em> intervals with a single command.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model weighted by phi hat</span></span>
<span><span class="fu"><a href="../reference/RRor.html">RRor</a></span><span class="op">(</span><span class="fu"><a href="../reference/phiWt.html">phiWt</a></span><span class="op">(</span><span class="va">bird.fit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 95% t intervals on 4 df</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">##     PF     LL     UL </span></span>
<span><span class="co">##  0.500 -0.583  0.842 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       mu.hat    LL     UL</span></span>
<span><span class="co">## txcon  0.733 0.943 0.3121</span></span>
<span><span class="co">## txvac  0.367 0.752 0.0997</span></span></code></pre>
<p>It also allows different estimates of <span class="math inline">\({\hat{\varphi}}\)</span> for specified subsets of the data.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model with separate phi for vaccinates and controls</span></span>
<span><span class="fu"><a href="../reference/RRor.html">RRor</a></span><span class="op">(</span><span class="fu"><a href="../reference/phiWt.html">phiWt</a></span><span class="op">(</span><span class="va">bird.fit</span>, subset.factor <span class="op">=</span> <span class="va">bird</span><span class="op">$</span><span class="va">tx</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 95% t intervals on 4 df</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">##     PF     LL     UL </span></span>
<span><span class="co">##  0.500 -0.645  0.848 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       mu.hat    LL     UL</span></span>
<span><span class="co">## txcon  0.733 0.938 0.3330</span></span>
<span><span class="co">## txvac  0.367 0.767 0.0925</span></span></code></pre>
<p>If you want to subtract a degree of freedom for each additional parameter, you can do that by entering the degrees of freedom as an argument to <code><a href="../reference/RRor.html">RRor()</a></code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subtract 2 degrees of freedom</span></span>
<span><span class="fu"><a href="../reference/RRor.html">RRor</a></span><span class="op">(</span><span class="fu"><a href="../reference/phiWt.html">phiWt</a></span><span class="op">(</span><span class="va">bird.fit</span>, subset.factor <span class="op">=</span> <span class="va">bird</span><span class="op">$</span><span class="va">tx</span><span class="op">)</span>, degf <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 95% t intervals on 2 df</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">##     PF     LL     UL </span></span>
<span><span class="co">##  0.500 -2.164  0.921 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       mu.hat    LL     UL</span></span>
<span><span class="co">## txcon  0.733 0.975 0.1635</span></span>
<span><span class="co">## txvac  0.367 0.895 0.0377</span></span></code></pre>
</div>
<div class="section level4" number="4.2.2">
<h4 id="dispersion-parameter-tau">
<span class="header-section-number">4.2.2</span> Dispersion parameter <span class="math inline">\(\tau\)</span><a class="anchor" aria-label="anchor" href="#dispersion-parameter-tau"></a>
</h4>
<p>When overdispersion is due to intra-cluster correlation, it may make sense to estimate the dispersion as a function of the intra-cluster correlation parameter <span class="math inline">\(\tau\)</span>. In other words, <span class="math inline">\({a({\varphi }_{ij})}=1+{{\tau }_{j}}({{n}_{ij}}-1)\)</span>. <code><a href="../reference/tauWt.html">tauWt()</a></code> does this using the Williams procedure <span class="citation">(Williams 1982)</span>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model weighted using tau hat</span></span>
<span><span class="fu"><a href="../reference/RRor.html">RRor</a></span><span class="op">(</span><span class="fu"><a href="../reference/tauWt.html">tauWt</a></span><span class="op">(</span><span class="va">bird.fit</span>, subset.factor <span class="op">=</span> <span class="va">bird</span><span class="op">$</span><span class="va">tx</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 95% t intervals on 4 df</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">##     PF     LL     UL </span></span>
<span><span class="co">##  0.500 -0.645  0.848 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       mu.hat    LL     UL</span></span>
<span><span class="co">## txcon  0.733 0.938 0.3330</span></span>
<span><span class="co">## txvac  0.367 0.767 0.0925</span></span></code></pre>
<p>In this example the <code><a href="../reference/tauWt.html">tauWt()</a></code> estimates are the same as the <code><a href="../reference/phiWt.html">phiWt()</a></code> estimates. That is because the cluster sizes are all the same. Let’s see what happens if we modify the <code>bird</code> data set. The <code>birdm</code> data set has the same cluster fractions but differing cluster sizes.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># different cluster sizes, same cluster fractions</span></span>
<span><span class="va">birdm.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">n</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">binomial</span>, <span class="va">birdm</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/RRor.html">RRor</a></span><span class="op">(</span><span class="fu"><a href="../reference/tauWt.html">tauWt</a></span><span class="op">(</span><span class="va">birdm.fit</span>, subset.factor <span class="op">=</span> <span class="va">birdm</span><span class="op">$</span><span class="va">tx</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 95% t intervals on 4 df</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">##     PF     LL     UL </span></span>
<span><span class="co">##  0.490 -0.605  0.838 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       mu.hat    LL    UL</span></span>
<span><span class="co">## txcon  0.737 0.942 0.328</span></span>
<span><span class="co">## txvac  0.376 0.764 0.101</span></span></code></pre>
<p>Note that increasing cluster size can make things worse when there is intra-cluster correlation.</p>
<p>Now let’s compare the weights from <code><a href="../reference/phiWt.html">phiWt()</a></code> and <code><a href="../reference/tauWt.html">tauWt()</a></code> with unequal cluster sizes.
In the output below, <code>w</code> represents <span class="math inline">\(1/a(\hat{\varphi })\;\)</span> and <code>nw</code> is <span class="math inline">\(n/a(\hat{\varphi })\;\)</span></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare phi and tau weights</span></span>
<span><span class="co">#</span></span>
<span><span class="va">phi.wts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phiWt.html">phiWt</a></span><span class="op">(</span><span class="va">birdm.fit</span>, fit.only <span class="op">=</span> <span class="cn">FALSE</span>, subset.factor <span class="op">=</span> <span class="va">birdm</span><span class="op">$</span><span class="va">tx</span><span class="op">)</span><span class="op">$</span><span class="va">weights</span></span>
<span><span class="va">tau.wts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tauWt.html">tauWt</a></span><span class="op">(</span><span class="va">birdm.fit</span>, fit.only <span class="op">=</span> <span class="cn">FALSE</span>, subset.factor <span class="op">=</span> <span class="va">birdm</span><span class="op">$</span><span class="va">tx</span><span class="op">)</span><span class="op">$</span><span class="va">weights</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>w.phi  <span class="op">=</span> <span class="va">phi.wts</span>,</span>
<span>           w.tau  <span class="op">=</span> <span class="va">tau.wts</span>,</span>
<span>           nw.phi <span class="op">=</span> <span class="va">phi.wts</span> <span class="op">*</span> <span class="va">birdm</span><span class="op">$</span><span class="va">n</span>,</span>
<span>           nw.tau <span class="op">=</span> <span class="va">tau.wts</span> <span class="op">*</span> <span class="va">birdm</span><span class="op">$</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">birdm</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">w</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   tx  y  n w.phi w.tau nw.phi nw.tau</span></span>
<span><span class="co">##  vac  1 10  0.32  0.35   3.20   3.55</span></span>
<span><span class="co">##  vac  8 20  0.32  0.21   6.40   4.13</span></span>
<span><span class="co">##  vac  9 15  0.32  0.26   4.80   3.92</span></span>
<span><span class="co">##  con  8 16  0.21  0.27   3.39   4.33</span></span>
<span><span class="co">##  con  8 10  0.21  0.38   2.12   3.82</span></span>
<span><span class="co">##  con 27 30  0.21  0.16   6.36   4.84</span></span></code></pre>
<p>Look at the last two rows. Note that the <code>nw.phi</code> are directly proportional to <code>n</code> within treatment group, while the <code>nw.tau</code> are not. With intra-cluster correlation, increasing cluster size does not give a corresponding increase in information.</p>
</div>
</div>
<div class="section level3" number="4.3">
<h3 id="rao-scott-weights">
<span class="header-section-number">4.3</span> Rao-Scott weights<a class="anchor" aria-label="anchor" href="#rao-scott-weights"></a>
</h3>
<p><span class="citation">(Rao and Scott 1992)</span> give a method of weighting clustered binomial observations based on the variance inflation due to clustering.
They relate their approach to the concepts of design effect and effective sample size familiar in survey sampling, and they illustrate its use in a variety of contexts.
<code><a href="../reference/rsbWt.html">rsbWt()</a></code> implements it in the same manner as <code><a href="../reference/phiWt.html">phiWt()</a></code> and <code><a href="../reference/tauWt.html">tauWt()</a></code>. For more general use, the function <code><a href="../reference/rsb.html">rsb()</a></code> just returns the design effect estimates and the weights.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># model weighted with Rao-Scott weights</span></span>
<span><span class="fu"><a href="../reference/RRor.html">RRor</a></span><span class="op">(</span><span class="fu"><a href="../reference/rsbWt.html">rsbWt</a></span><span class="op">(</span><span class="va">birdm.fit</span>, subset.factor <span class="op">=</span> <span class="va">birdm</span><span class="op">$</span><span class="va">tx</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 95% t intervals on 4 df</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">##     PF     LL     UL </span></span>
<span><span class="co">##  0.479 -0.314  0.793 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       mu.hat    LL    UL</span></span>
<span><span class="co">## txcon  0.768 0.960 0.311</span></span>
<span><span class="co">## txvac  0.400 0.717 0.149</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># just the design effect estimates</span></span>
<span><span class="fu"><a href="../reference/rsb.html">rsb</a></span><span class="op">(</span><span class="va">birdm</span><span class="op">$</span><span class="va">y</span>, <span class="va">birdm</span><span class="op">$</span><span class="va">n</span><span class="op">)</span><span class="op">$</span><span class="va">d</span></span></code></pre></div>
<pre><code><span><span class="co">##      all </span></span>
<span><span class="co">## 6.334514</span></span></code></pre>
</div>
</div>
<div class="section level2" number="5">
<h2 id="likelihood-based-intervals">
<span class="header-section-number">5</span> Likelihood based intervals<a class="anchor" aria-label="anchor" href="#likelihood-based-intervals"></a>
</h2>
<p>The <code><a href="../reference/RRlsi.html">RRlsi()</a></code> function estimates likelihood support intervals for <em>RR</em> by the profile likelihood Section 7.6 <span class="citation">(Royall 1997)</span>.</p>
<p>Likelihood support intervals are usually formed based on the desired likelihood ratio, <span class="math inline">\({1}/{k}\;\)</span>, often <span class="math inline">\({1}/{8}\;\)</span> or <span class="math inline">\({1}/{32}\;\)</span>. Under some conditions the log likelihood ratio may follow the chi-square distribution. If so, then <span class="math inline">\(\alpha =1-{{F}_{{{\chi }^{2}}}}\left( 2\log (k),1 \right)\)</span>. <code><a href="../reference/RRsc.html">RRsc()</a></code> will make the conversion from <span class="math inline">\(\alpha\)</span> to <span class="math inline">\(k\)</span> with the argument <code>use.alpha = T</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/RRlsi.html">RRlsi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">24</span>, <span class="fl">12</span>, <span class="fl">28</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 1/8 likelihood support interval for PF </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## corresponds to 95.858% confidence</span></span>
<span><span class="co">##   (under certain assumptions)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">##     PF     LL     UL </span></span>
<span><span class="co">## 0.6111 0.0168 0.8859</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/RRlsi.html">RRlsi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">24</span>, <span class="fl">12</span>, <span class="fl">28</span><span class="op">)</span>, use.alpha <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 1/6.826 likelihood support interval for PF </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## corresponds to 95% confidence</span></span>
<span><span class="co">##   (under certain assumptions)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## PF </span></span>
<span><span class="co">##     PF     LL     UL </span></span>
<span><span class="co">## 0.6111 0.0495 0.8792</span></span></code></pre>
</div>
<div class="section level2" number="6">
<h2 id="incidence-ratio">
<span class="header-section-number">6</span> Incidence ratio<a class="anchor" aria-label="anchor" href="#incidence-ratio"></a>
</h2>
<p>The incidence is the number of cases per subject-time. Its distribution is assumed Poisson. Under certain designs, the incidence ratio (<span class="math inline">\(IR\)</span>) is used as a measure of treatment effect. Correspondingly, <span class="math inline">\({{PF}_{IR}}=1-IR\)</span> would be used as a measure of effect for an intervention that is preventive, such as vaccination. <span class="math inline">\(IR\)</span> is also called incidence density ratio (<span class="math inline">\(IDR\)</span>), and that is the term used in the following functions.</p>
<div class="section level3" number="6.1">
<h3 id="score-method">
<span class="header-section-number">6.1</span> Score method<a class="anchor" aria-label="anchor" href="#score-method"></a>
</h3>
<p><code><a href="../reference/IDRsc.html">IDRsc()</a></code> estimates a confidence interval for the incidence density ratio using Siev’s formula Appendix 1 <span class="citation">(Siev 1994)</span> based on the Poisson score statistic<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;This formula was published in a Japanese journal &lt;span class="citation"&gt;(Sato 1988)&lt;/span&gt; several years before Siev. See also &lt;span class="citation"&gt;(Graham, Mengersen, and Morton 2003)&lt;/span&gt; and &lt;span class="citation"&gt;(Siev 2004)&lt;/span&gt;.&lt;/p&gt;'><sup>3</sup></a>.
<span class="math display">\[IDR=\widehat{IDR}\left\{ 1+\left( \frac{1}{{{y}_{1}}}+\frac{1}{{{y}_{2}}} \right)\frac{z_{\alpha /2}^{2}}{2}\ \ \pm \ \ \frac{z_{\alpha /2}^{2}}{2{{y}_{1}}{{y}_{2}}}\sqrt{{{y}_{\bullet }}\left( {{y}_{\bullet }}z_{\alpha /2}^{2}+4{{y}_{1}}{{y}_{2}} \right)} \right\}\]</span></p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/IDRsc.html">IDRsc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">26</span>, <span class="fl">204</span>, <span class="fl">10</span>, <span class="fl">205</span><span class="op">)</span>, pf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## IDR </span></span>
<span><span class="co">## 95% interval estimates</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  IDR   LL   UL </span></span>
<span><span class="co">## 2.61 1.28 5.34</span></span></code></pre>
</div>
<div class="section level3" number="6.2">
<h3 id="likelihood-method">
<span class="header-section-number">6.2</span> Likelihood method<a class="anchor" aria-label="anchor" href="#likelihood-method"></a>
</h3>
<p>A likelihood support interval for <span class="math inline">\(IDR\)</span> may be estimated based on orthogonal factoring of the reparameterized likelihood. Section 7.2 <span class="citation">(Royall 1997)</span> <code><a href="../reference/IDRlsi.html">IDRlsi()</a></code> implements this method.</p>
<p>Likelihood support intervals are usually formed based on the desired likelihood ratio, <span class="math inline">\({1}/{k}\;\)</span>, often <span class="math inline">\({1}/{8}\;\)</span> or <span class="math inline">\({1}/{32}\;\)</span>. Under some conditions the log likelihood ratio may follow the chi square distribution. If so, then <span class="math inline">\(\alpha =1-{{F}_{{{\chi }^{2}}}}\left( 2\log (k),1 \right)\)</span>. <code><a href="../reference/IDRlsi.html">IDRlsi()</a></code> will make the conversion from <span class="math inline">\(\alpha\)</span> tp <span class="math inline">\(k\)</span> with the argument <code>use.alpha = T</code>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/IDRlsi.html">IDRlsi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">26</span>, <span class="fl">204</span>, <span class="fl">10</span>, <span class="fl">205</span><span class="op">)</span>, pf <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 1/8 likelihood support interval for IDR </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## corresponds to 95.858% confidence</span></span>
<span><span class="co">##   (under certain assumptions)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## IDR </span></span>
<span><span class="co">##  IDR   LL   UL </span></span>
<span><span class="co">## 2.61 1.26 5.88</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/IDRlsi.html">IDRlsi</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">26</span>, <span class="fl">204</span>, <span class="fl">10</span>, <span class="fl">205</span><span class="op">)</span>, pf <span class="op">=</span> <span class="cn">FALSE</span>, use.alpha <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## 1/6.826 likelihood support interval for IDR </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## corresponds to 95% confidence</span></span>
<span><span class="co">##   (under certain assumptions)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## IDR </span></span>
<span><span class="co">##  IDR   LL   UL </span></span>
<span><span class="co">## 2.61 1.30 5.69</span></span></code></pre>
<!-- \bibliographystyle{asa} -->
<!-- \bibliography{PF} -->
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-AA01" class="csl-entry">
Agresti, A. 2001. <span>“Exact Inference for Categorical Data: Recent Advances and Continuing Controversies.”</span> <em>Statistics in Medicine</em> 20: 2709–22.
</div>
<div id="ref-AA03" class="csl-entry">
———. 2003. <span>“Dealing with Discreteness: Making <span>‘Exact’</span> Confidence Intervals for Proportions, Differences of Proportions, and Odds Ratios More Exact.”</span> <em>Statistical Methods in Medical Research</em> 12: 3–21.
</div>
<div id="ref-AH00" class="csl-entry">
Agresti, A., and J. Hartzel. 2000. <span>“Strategies for Comparing Treatments on a Binary Response with Multi-Centre Data.”</span> <em>Statistics in Medicine</em> 19: 1115–39.
</div>
<div id="ref-AM01" class="csl-entry">
Agresti, A., and Y. Min. 2001. <span>“On Small-Sample Confidence Intervals for Parameters in Discrete Distributions.”</span> <em>Biometrics</em> 57: 963–71.
</div>
<div id="ref-BB94" class="csl-entry">
Berger, R. L., and D. D. Boos. 1994. <span>“P Values Maximized over a Confidence Set for the Nuisance Parameter.”</span> <em>Journal of the American Statistical Association</em> 89: 214–20.
</div>
<div id="ref-Coc54" class="csl-entry">
Cochran, W. G. 1954. <span>“Some Methods for Strengthening the Common Chi-Square Tests.”</span> <em>Biometrics</em> 10: 417–51.
</div>
<div id="ref-Gart85" class="csl-entry">
Gart, J. J. 1985. <span>“Approximate Tests and Interval Estimation of the Common Relative Risk in the Combination of <span class="math inline">\(2 \times 2\)</span> Tables.”</span> <em>Biometrika</em> 72: 673–77.
</div>
<div id="ref-GN88" class="csl-entry">
Gart, J. J., and J. Nam. 1988. <span>“Approximate Interval Estimation of the Ratio of Binomial Parameters: A Review and Corrections for Skewness.”</span> <em>Biometrics</em> 44: 323–38.
</div>
<div id="ref-GMM03" class="csl-entry">
Graham, P. L., K. Mengersen, and A. P. Morton. 2003. <span>“Confidence Limits for the Ratio of Two Rates Based on Likelihood Scores: Non-Iterative Method.”</span> <em>Statistics in Medicine</em> 22: 2071–83.
</div>
<div id="ref-GR85" class="csl-entry">
Greenland, S., and J. M. Robins. 1985. <span>“Estimation of a Common Effect Parameter from Sparse Follow-up Data.”</span> <em>Biometrics</em> 41: 55–68.
</div>
<div id="ref-Koop84" class="csl-entry">
Koopman, P. A. R. 1984. <span>“Confidence Intervals for the Ratio of Two Binomial Proportions.”</span> <em>Biometrics</em> 40: 513–17.
</div>
<div id="ref-KLK88" class="csl-entry">
Kuritz, S. J., J. R. Landis, and G. G. Koch. 1988. <span>“A General Overview of Mantel-Haenszel Methods: Applications and Recent Developments.”</span> <em>Annual Review of Public Health</em> 9: 123–60.
</div>
<div id="ref-Lachin00" class="csl-entry">
Lachin, J. M. 2000. <em>Biostatistical Methods: The Assessment of Relative Risks</em>. New York: Wiley.
</div>
<div id="ref-LSKK05" class="csl-entry">
Landis, J. R., T. J. Sharp, S. J. Kuritz, and G. G. Koch. 2005. <span>“Mantel-Haenszel Methods.”</span> In <em>Encyclopedia of Biostatistics</em>, edited by P. Armitage and T. Colton, Second, 4:2937–50. Chichester: Wiley.
</div>
<div id="ref-MH59" class="csl-entry">
Mantel, N., and W. Haenszel. 1959. <span>“Statistical Aspects of the Analysis of Data from Retrospective Studies of Disease.”</span> <em>Journal of the National Cancer Institute</em> 22: 719–48.
</div>
<div id="ref-MN85" class="csl-entry">
Miettinen, O., and M. Nurminen. 1985. <span>“Comparative Analysis of Two Rates.”</span> <em>Statistics in Medicine</em> 4: 213–26.
</div>
<div id="ref-Rad65" class="csl-entry">
Radhakrishnan, S. 1965. <span>“Combination of Results from Several <span class="math inline">\(2 \times 2\)</span> Contingency Tables.”</span> <em>Biometrics</em> 21: 86–98.
</div>
<div id="ref-RJ78" class="csl-entry">
Ralston, M. L., and R. I. Jennrich. 1978. <span>“DUD, a Derivative-Free Algorithm for Nonlinear Least Squares.”</span> <em>Technometrics</em> 20: 7–14.
</div>
<div id="ref-RS92" class="csl-entry">
Rao, J. N. K., and A. J. Scott. 1992. <span>“A Simple Method for the Analysis of Clustered Binary Data.”</span> <em>Biometrics</em> 48: 577–85.
</div>
<div id="ref-Roy97" class="csl-entry">
Royall, R. 1997. <em>Statistical Evidence: A Likelihood Paradigm</em>. Boca Raton: Chapman; Hall.
</div>
<div id="ref-Sato88" class="csl-entry">
Sato, T. 1988. <span>“Confidence Intervals for Effect Parameters from Cohort Studies Based on Efficient Scores.”</span> <em>Japanese Journal of Applied Statistics</em> 17: 43–54.
</div>
<div id="ref-Siev94" class="csl-entry">
Siev, D. 1994. <span>“Estimating Vaccine Efficacy in Prospective Studies.”</span> <em>Preventive Veterinary Medicine</em> 20: 279–96.
</div>
<div id="ref-Siev04" class="csl-entry">
———. 2004. <span>“Letter to the Editor: Confidence Limits for the Ratio of Two Rates Based on Likelihood Scores, Non-Iterative Method.”</span> <em>Statistics in Medicine</em> 23: 693.
</div>
<div id="ref-SO06" class="csl-entry">
Somes, G. W., and K. F. O’Brien. 2006. <span>“Mantel-Haenszel Statistics.”</span> In <em>Encyclopedia of Statistical Sciences</em>, edited by S. Kotz, N. Balakrishnan, C. B. Read, and B. Vidakovic, Second, 7:4483–86. Hoboken: Wiley.
</div>
<div id="ref-Wil82" class="csl-entry">
Williams, D. A. 1982. <span>“Extra-Binomial Variation in Logistic Linear Models.”</span> <em>Applied Statistics</em> 31: 144–48.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by CVB Statistics, David Siev, Marie Vendettuoli, Thomas Kent.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
